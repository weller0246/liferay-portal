definition {

	macro addComment {
		PageEditor.assertFragmentSidebarLoaded();

		PageEditor.gotoTab(tabName = "Comments");

		if (IsElementNotPresent(key_fragmentName = "${fragmentName}", locator1 = "PageEditor#FRAGMENT_SIDEBAR_COMMENT_SECTION_NAME")) {
			Click(
				key_fragmentName = "${fragmentName}",
				locator1 = "Fragment#FRAGMENT_BODY");
		}

		AssertElementPresent(
			key_fragmentName = "${fragmentName}",
			locator1 = "PageEditor#FRAGMENT_SIDEBAR_COMMENT_SECTION_NAME");

		Click.clickAt(locator1 = "PageEditor#FRAGMENT_SIDEBAR_COMMENTS");

		if (isSet(mentionsUserScreenName)) {
			var key_mentionsUserScreenName = "${mentionsUserScreenName}";

			Type.sendKeys(
				locator1 = "PageEditor#FRAGMENT_SIDEBAR_COMMENTS",
				value1 = "${fragmentComment} @${mentionsUserScreenName}");

			Click.clickNoMouseOver(locator1 = "Mentions#MENTIONS_USER_DISPLAY_OPTION");
		}

		else {
			Type(
				locator1 = "PageEditor#FRAGMENT_SIDEBAR_COMMENTS",
				value1 = "${fragmentComment}");
		}

		Button.clickComment();

		AssertElementNotPresent(
			key_fragmentComment = "${fragmentComment}",
			locator1 = "PageEditor#FRAGMENT_SIDEBAR_COMMENT_ENTRY_INPUT");
	}

	macro addCommentViaFragment {
		PageEditor.gotoCommentViaFragment(
			fragmentName = "${fragmentName}",
			key_content = "${content}",
			key_fragmentClass = "${fragmentClass}",
			key_position = "${position}");

		AssertElementPresent(
			key_fragmentName = "${fragmentName}",
			locator1 = "PageEditor#FRAGMENT_SIDEBAR_COMMENT_SECTION_NAME");

		Click.clickAt(locator1 = "PageEditor#FRAGMENT_SIDEBAR_COMMENTS");

		Type(
			locator1 = "PageEditor#FRAGMENT_SIDEBAR_COMMENTS",
			value1 = "${fragmentComment}");

		Button.clickComment();

		AssertElementNotPresent(
			key_fragmentComment = "${fragmentComment}",
			locator1 = "PageEditor#FRAGMENT_SIDEBAR_COMMENT_ENTRY_INPUT");
	}

	macro addElementToColumn {
		if (!(isSet(position))) {
			var position = "1";
		}

		PageEditor.gotoTab(tabName = "Fragments and Widgets");

		if (!(isSet(displayStyle))) {
			var displayStyle = "list";
		}

		if (IsElementNotPresent(key_displayStyle = "${displayStyle}", locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_DISPLAY_STYLE_BUTTON")) {
			Click(
				key_displayStyle = "",
				locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_DISPLAY_STYLE_BUTTON");
		}

		AssertVisible(
			key_displayStyle = "${displayStyle}",
			locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_DISPLAY_STYLE_BUTTON");

		Navigator.gotoNavTab(navTab = "${navTab}");

		if (("${navTab}" == "Fragments") && ("${displayStyle}" == "card")) {
			PageEditor.expandFragmentCollection(collectionName = "${collectionName}");

			if ((isSet(targetFragmentName)) && ("${height}" == "Short")) {
				DragAndDrop.javaScriptDragAndDropObjectBelowShortNestedObject(
					key_collectionName = "${collectionName}",
					key_fragmentName = "${fragmentName}",
					key_targetFragmentName = "${targetFragmentName}",
					locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_FRAGMENT_CARD_ITEM",
					locator2 = "PageEditor#ANY_NESTED_FRAGMENT_DROP_TARGET",
					value1 = "");
			}

			if ((isSet(targetFragmentName)) && ("${height}" == "Tall")) {
				DragAndDrop.javaScriptDragAndDropObjectBelowTallNestedObject(
					key_collectionName = "${collectionName}",
					key_fragmentName = "${fragmentName}",
					key_targetFragmentName = "${targetFragmentName}",
					locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_FRAGMENT_CARD_ITEM",
					locator2 = "PageEditor#ANY_NESTED_FRAGMENT_DROP_TARGET",
					value1 = "");
			}

			else {
				DragAndDrop.javaScriptDragAndDropToObject(
					key_collectionName = "${collectionName}",
					key_columnNumber = "${columnNumber}",
					key_fragmentName = "${fragmentName}",
					key_position = "${position}",
					locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_FRAGMENT_CARD_ITEM",
					locator2 = "PageEditor#GRID_COLUMN",
					value1 = "");
			}
		}

		if (("${navTab}" == "Fragments") && ("${displayStyle}" == "list")) {
			PageEditor.expandFragmentCollection(collectionName = "${collectionName}");

			if ((isSet(targetFragmentName)) && ("${height}" == "Short")) {
				DragAndDrop.javaScriptDragAndDropObjectBelowShortNestedObject(
					key_collectionName = "${collectionName}",
					key_fragmentName = "${fragmentName}",
					key_targetFragmentName = "${targetFragmentName}",
					locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_FRAGMENT",
					locator2 = "PageEditor#ANY_NESTED_FRAGMENT_DROP_TARGET",
					value1 = "");
			}

			if ((isSet(targetFragmentName)) && ("${height}" == "Tall")) {
				DragAndDrop.javaScriptDragAndDropObjectBelowTallNestedObject(
					key_collectionName = "${collectionName}",
					key_fragmentName = "${fragmentName}",
					key_targetFragmentName = "${targetFragmentName}",
					locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_FRAGMENT",
					locator2 = "PageEditor#ANY_NESTED_FRAGMENT_DROP_TARGET",
					value1 = "");
			}

			else {
				DragAndDrop.javaScriptDragAndDropToObject(
					key_collectionName = "${collectionName}",
					key_columnNumber = "${columnNumber}",
					key_fragmentName = "${fragmentName}",
					key_position = "${position}",
					locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_FRAGMENT",
					locator2 = "PageEditor#GRID_COLUMN",
					value1 = "");
			}
		}

		if (("${navTab}" == "Widgets") && ("${displayStyle}" == "card")) {
			Type.sendKeysApplicationSearch(
				locator1 = "PageEditor#WIDGETS_APPLICATION_SEARCH_FIELD",
				value1 = "${portletName}");

			if ((isSet(targetFragmentName)) && ("${height}" == "Short")) {
				DragAndDrop.javaScriptDragAndDropObjectBelowShortNestedObject(
					key_portletName = "${portletName}",
					key_targetFragmentName = "${targetFragmentName}",
					locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_WIDGET_CARD_ITEM",
					locator2 = "PageEditor#ANY_NESTED_FRAGMENT_DROP_TARGET",
					value1 = "${portletName}");
			}

			if ((isSet(targetFragmentName)) && ("${height}" == "Tall")) {
				DragAndDrop.javaScriptDragAndDropObjectBelowTallNestedObject(
					key_portletName = "${portletName}",
					key_targetFragmentName = "${targetFragmentName}",
					locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_WIDGET_CARD_ITEM",
					locator2 = "PageEditor#ANY_NESTED_FRAGMENT_DROP_TARGET",
					value1 = "${portletName}");
			}

			else {
				DragAndDrop.javaScriptDragAndDropToObject(
					key_columnNumber = "${columnNumber}",
					key_portletName = "${portletName}",
					key_position = "${position}",
					locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_WIDGET_CARD_ITEM",
					locator2 = "PageEditor#GRID_COLUMN",
					value1 = "${portletName}");
			}
		}

		if (("${navTab}" == "Widgets") && ("${displayStyle}" == "list")) {
			Type.sendKeysApplicationSearch(
				locator1 = "PageEditor#WIDGETS_APPLICATION_SEARCH_FIELD",
				value1 = "${portletName}");

			if ((isSet(targetFragmentName)) && ("${height}" == "Short")) {
				DragAndDrop.javaScriptDragAndDropObjectBelowShortNestedObject(
					key_portletName = "${portletName}",
					key_targetFragmentName = "${targetFragmentName}",
					locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_WIDGET",
					locator2 = "PageEditor#ANY_NESTED_FRAGMENT_DROP_TARGET",
					value1 = "${portletName}");
			}

			if ((isSet(targetFragmentName)) && ("${height}" == "Tall")) {
				DragAndDrop.javaScriptDragAndDropObjectBelowTallNestedObject(
					key_portletName = "${portletName}",
					key_targetFragmentName = "${targetFragmentName}",
					locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_WIDGET",
					locator2 = "PageEditor#ANY_NESTED_FRAGMENT_DROP_TARGET",
					value1 = "${portletName}");
			}

			else {
				DragAndDrop.javaScriptDragAndDropToObject(
					key_columnNumber = "${columnNumber}",
					key_portletName = "${portletName}",
					key_position = "${position}",
					locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_WIDGET",
					locator2 = "PageEditor#GRID_COLUMN",
					value1 = "${portletName}");
			}
		}

		PageEditor.waitForAutoSave();

		if ("${navTab}" == "Fragments") {
			AssertElementPresent(
				key_columnNumber = "${columnNumber}",
				key_elementHeader = "//li[contains(@class,'topper__title') and contains(.,'${fragmentName}')]",
				key_position = "${position}",
				locator1 = "PageEditor#GRID_COLUMN_NESTED_ELEMENT");
		}

		if ("${navTab}" == "Widgets") {
			AssertElementPresent(
				key_columnNumber = "${columnNumber}",
				key_elementHeader = "//li[contains(@class,'topper__title') and contains(.,'${portletName}')]",
				key_position = "${position}",
				locator1 = "PageEditor#GRID_COLUMN_NESTED_ELEMENT");

			PageEditor.gotoTab(tabName = "Contents");

			PageEditor.gotoTab(tabName = "Fragments and Widgets");

			PageEditor.closeSidebar(tabName = "Fragments and Widgets");
		}
	}

	macro addElementToContainer {
		if (!(isSet(position))) {
			var position = "1";
		}

		PageEditor.gotoTab(tabName = "Fragments and Widgets");

		if (!(isSet(displayStyle))) {
			var displayStyle = "list";
		}

		if (IsElementNotPresent(key_displayStyle = "${displayStyle}", locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_DISPLAY_STYLE_BUTTON")) {
			Click(
				key_displayStyle = "",
				locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_DISPLAY_STYLE_BUTTON");
		}

		AssertVisible(
			key_displayStyle = "${displayStyle}",
			locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_DISPLAY_STYLE_BUTTON");

		Navigator.gotoNavTab(navTab = "${navTab}");

		if (("${navTab}" == "Fragments") && ("${displayStyle}" == "card")) {
			PageEditor.expandFragmentCollection(collectionName = "${collectionName}");

			DragAndDrop.javaScriptDragAndDropToObject(
				key_collectionName = "${collectionName}",
				key_elementType = "Container",
				key_fragmentName = "${fragmentName}",
				key_position = "${position}",
				locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_FRAGMENT_CARD_ITEM",
				locator2 = "PageEditor#CONTAINER_CONTAINER",
				value1 = "");
		}

		if (("${navTab}" == "Fragments") && ("${displayStyle}" == "list")) {
			PageEditor.expandFragmentCollection(collectionName = "${collectionName}");

			DragAndDrop.javaScriptDragAndDropToObject(
				key_collectionName = "${collectionName}",
				key_elementType = "Container",
				key_fragmentName = "${fragmentName}",
				key_position = "${position}",
				locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_FRAGMENT",
				locator2 = "PageEditor#CONTAINER_CONTAINER",
				value1 = "");
		}

		if (("${navTab}" == "Widgets") && ("${displayStyle}" == "card")) {
			Type.sendKeysApplicationSearch(
				locator1 = "PageEditor#WIDGETS_APPLICATION_SEARCH_FIELD",
				value1 = "${portletName}");

			DragAndDrop.javaScriptDragAndDropToObject(
				key_elementType = "Container",
				key_portletName = "${portletName}",
				key_position = "${position}",
				locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_WIDGET_CARD_ITEM",
				locator2 = "PageEditor#CONTAINER_CONTAINER",
				value1 = "${portletName}");
		}

		if (("${navTab}" == "Widgets") && ("${displayStyle}" == "list")) {
			Type.sendKeysApplicationSearch(
				locator1 = "PageEditor#WIDGETS_APPLICATION_SEARCH_FIELD",
				value1 = "${portletName}");

			DragAndDrop.javaScriptDragAndDropToObject(
				key_elementType = "Container",
				key_portletName = "${portletName}",
				key_position = "${position}",
				locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_WIDGET",
				locator2 = "PageEditor#CONTAINER_CONTAINER",
				value1 = "${portletName}");
		}

		PageEditor.waitForAutoSave();

		if ("${navTab}" == "Fragments") {
			AssertElementPresent(
				key_elementHeader = "//li[contains(@class,'topper__title') and contains(.,'${fragmentName}')]",
				key_elementType = "Container",
				key_position = "${position}",
				locator1 = "PageEditor#CONTAINER_CONTAINER_NESTED_ELEMENT");
		}

		if ("${navTab}" == "Widgets") {
			AssertElementPresent(
				key_elementHeader = "//li[contains(@class,'topper__title') and contains(.,'${portletName}')]",
				key_elementType = "Container",
				key_position = "${position}",
				locator1 = "PageEditor#CONTAINER_CONTAINER_NESTED_ELEMENT");

			PageEditor.gotoTab(tabName = "Contents");

			PageEditor.gotoTab(tabName = "Fragments and Widgets");

			PageEditor.closeSidebar(tabName = "Fragments and Widgets");
		}
	}

	macro addElementToDropdownPanel {
		PageEditor.gotoTab(tabName = "Fragments and Widgets");

		if (!(isSet(displayStyle))) {
			var displayStyle = "list";
		}

		if (IsElementNotPresent(key_displayStyle = "${displayStyle}", locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_DISPLAY_STYLE_BUTTON")) {
			Click(
				key_displayStyle = "",
				locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_DISPLAY_STYLE_BUTTON");
		}

		AssertVisible(
			key_displayStyle = "${displayStyle}",
			locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_DISPLAY_STYLE_BUTTON");

		Navigator.gotoNavTab(navTab = "${navTab}");

		if (("${navTab}" == "Fragments") && ("${displayStyle}" == "card")) {
			PageEditor.expandFragmentCollection(collectionName = "${collectionName}");

			DragAndDrop.javaScriptDragAndDropToObject(
				key_collectionName = "${collectionName}",
				key_element = "//div[contains(@class,'page-editor__root page-editor__topper')]",
				key_fragmentName = "${fragmentName}",
				locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_FRAGMENT_CARD_ITEM",
				locator2 = "Fragment#DROPDOWN_FRAGMENT_MENU_CONTENT");
		}

		if (("${navTab}" == "Fragments") && ("${displayStyle}" == "list")) {
			PageEditor.expandFragmentCollection(collectionName = "${collectionName}");

			DragAndDrop.javaScriptDragAndDropToObject(
				key_collectionName = "${collectionName}",
				key_element = "//div[contains(@class,'page-editor__root page-editor__topper')]",
				key_fragmentName = "${fragmentName}",
				locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_FRAGMENT",
				locator2 = "Fragment#DROPDOWN_FRAGMENT_MENU_CONTENT");
		}

		if (("${navTab}" == "Widgets") && ("${displayStyle}" == "card")) {
			Type.sendKeysApplicationSearch(
				locator1 = "PageEditor#WIDGETS_APPLICATION_SEARCH_FIELD",
				value1 = "${portletName}");

			DragAndDrop.javaScriptDragAndDropToObject(
				key_element = "//div[contains(@class,'page-editor__root page-editor__topper')]",
				key_portletName = "${portletName}",
				locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_WIDGET_CARD_ITEM",
				locator2 = "Fragment#DROPDOWN_FRAGMENT_MENU_CONTENT");
		}

		if (("${navTab}" == "Widgets") && ("${displayStyle}" == "list")) {
			Type.sendKeysApplicationSearch(
				locator1 = "PageEditor#WIDGETS_APPLICATION_SEARCH_FIELD",
				value1 = "${portletName}");

			DragAndDrop.javaScriptDragAndDropToObject(
				key_element = "//div[contains(@class,'page-editor__root page-editor__topper')]",
				key_portletName = "${portletName}",
				locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_WIDGET",
				locator2 = "Fragment#DROPDOWN_FRAGMENT_MENU_CONTENT");
		}

		PageEditor.waitForAutoSave();

		if ("${navTab}" == "Fragments") {
			AssertElementPresent(
				key_fragmentName = "${fragmentName}",
				key_inFragmentName = "Dropdown",
				locator1 = "Fragment#FRAGMENT_BODY_IN_FRAGMENT");
		}

		if ("${navTab}" == "Widgets") {
			AssertElementPresent(
				key_fragmentName = "${portletName}",
				key_inFragmentName = "Dropdown",
				locator1 = "Fragment#FRAGMENT_BODY_IN_FRAGMENT");

			PageEditor.gotoTab(tabName = "Contents");

			PageEditor.gotoTab(tabName = "Fragments and Widgets");

			PageEditor.closeSidebar(tabName = "Fragments and Widgets");
		}
	}

	macro addElementToTab {
		PageEditor.gotoTabsFragmentNavItem(navItem = "${navItem}");

		AssertVisible(
			key_content = "Place fragments here.",
			key_fragmentClass = "content",
			key_position = "${position}",
			locator1 = "Fragment#PAGE_EDITOR_NO_FRAGMENTS_MESSAGE");

		PageEditor.gotoTab(tabName = "Fragments and Widgets");

		if (!(isSet(displayStyle))) {
			var displayStyle = "list";
		}

		if (IsElementNotPresent(key_displayStyle = "${displayStyle}", locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_DISPLAY_STYLE_BUTTON")) {
			Click(
				key_displayStyle = "",
				locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_DISPLAY_STYLE_BUTTON");
		}

		AssertVisible(
			key_displayStyle = "${displayStyle}",
			locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_DISPLAY_STYLE_BUTTON");

		Navigator.gotoNavTab(navTab = "${navTab}");

		if (("${navTab}" == "Fragments") && ("${displayStyle}" == "card")) {
			PageEditor.expandFragmentCollection(collectionName = "${collectionName}");

			DragAndDrop.javaScriptDragAndDropToObject(
				key_collectionName = "${collectionName}",
				key_fragmentName = "${fragmentName}",
				key_index = "${index}",
				locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_FRAGMENT_CARD_ITEM",
				locator2 = "PageEditor#FRAGMENT_WITH_DROP_TARGET",
				value1 = "");
		}

		if (("${navTab}" == "Fragments") && ("${displayStyle}" == "list")) {
			PageEditor.expandFragmentCollection(collectionName = "${collectionName}");

			DragAndDrop.javaScriptDragAndDropToObject(
				key_collectionName = "${collectionName}",
				key_fragmentName = "${fragmentName}",
				key_index = "${index}",
				locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_FRAGMENT",
				locator2 = "PageEditor#FRAGMENT_WITH_DROP_TARGET",
				value1 = "");
		}

		if (("${navTab}" == "Widgets") && ("${displayStyle}" == "card")) {
			Type.sendKeysApplicationSearch(
				locator1 = "PageEditor#WIDGETS_APPLICATION_SEARCH_FIELD",
				value1 = "${portletName}");

			DragAndDrop.javaScriptDragAndDropToObject(
				key_index = "${index}",
				key_portletName = "${portletName}",
				locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_WIDGET_CARD_ITEM",
				locator2 = "PageEditor#FRAGMENT_WITH_DROP_TARGET",
				value1 = "${portletName}");
		}

		if (("${navTab}" == "Widgets") && ("${displayStyle}" == "list")) {
			Type.sendKeysApplicationSearch(
				locator1 = "PageEditor#WIDGETS_APPLICATION_SEARCH_FIELD",
				value1 = "${portletName}");

			DragAndDrop.javaScriptDragAndDropToObject(
				key_index = "${index}",
				key_portletName = "${portletName}",
				locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_WIDGET",
				locator2 = "PageEditor#FRAGMENT_WITH_DROP_TARGET",
				value1 = "${portletName}");
		}

		PageEditor.waitForAutoSave();

		if ("${navTab}" == "Fragments") {
			AssertElementPresent(
				key_fragmentName = "${fragmentName}",
				key_inFragmentName = "Tabs",
				locator1 = "Fragment#FRAGMENT_BODY_IN_FRAGMENT");
		}

		if ("${navTab}" == "Widgets") {
			AssertElementPresent(
				key_fragmentName = "${portletName}",
				key_inFragmentName = "Tabs",
				locator1 = "Fragment#FRAGMENT_BODY_IN_FRAGMENT");

			PageEditor.gotoTab(tabName = "Contents");

			PageEditor.gotoTab(tabName = "Fragments and Widgets");

			PageEditor.closeSidebar(tabName = "Fragments and Widgets");
		}
	}

	macro addEntryWithLink {
		PageEditor.gotoEditableFieldEdit(
			contributed = "${contributed}",
			fragmentName = "${fragmentName}",
			id = "${id}");

		SelectFieldText(
			key_editor = "content",
			locator1 = "AlloyEditor#EDITOR");

		Click(locator1 = "AlloyEditor#TEXT_FORMATTING_LINK");

		Type(
			locator1 = "AlloyEditor#TEXT_FORMATTING_LINK_INPUT",
			value1 = "${entryExternalURL}");

		Click(locator1 = "AlloyEditor#TEXT_FORMATTING_LINK_INPUT_CONFIRM");

		Click(locator1 = "PageEditor#CONTENT_PAGE_DISABLED_HEADER");

		PageEditor.waitForAutoSave();
	}

	macro addExperience {
		var key_experienceName = "${experienceName}";
		var key_segmentName = "${segmentName}";

		AssertTextEquals(
			locator1 = "PageEditor#EXPERIENCE_LABEL",
			value1 = "Experience");

		Click(locator1 = "PageEditor#EXPERIENCE_DEFAULT_BUTTON_NAME");

		Click(
			key_text = "New Experience",
			locator1 = "Button#ANY");

		Type(
			locator1 = "PageEditor#EXPERIENCE_NAME",
			value1 = "${experienceName}");

		Select(
			locator1 = "PageEditor#EXPERIENCE_SELECT_SEGMENT",
			value1 = "${segmentName}");

		Click(locator1 = "Button#SAVE");

		AssertClick(
			locator1 = "PageEditor#EXPERIENCE_BUTTON_NAME",
			value1 = "${experienceName}");

		AssertElementPresent(
			key_experienceName = "${experienceName}",
			locator1 = "PageEditor#EXPERIENCE_SELECT_ITEM");
	}

	macro addExperienceWithLanguage {
		var key_experienceName = "${experienceName}";
		var key_segmentName = "${segmentName}";
		var key_language = "${language}";

		AssertTextEquals(
			locator1 = "PageEditor#EXPERIENCE_LABEL",
			value1 = "Experience");

		Click(locator1 = "PageEditor#EXPERIENCE_DEFAULT_BUTTON_NAME");

		Click(
			key_text = "New Experience",
			locator1 = "Button#ANY");

		Type(
			locator1 = "PageEditor#EXPERIENCE_NAME",
			value1 = "${experienceName}");

		Check.checkNotVisible(
			checkboxName = "${language}",
			locator1 = "Checkbox#ANY_CHECKBOX");

		Select(
			locator1 = "PageEditor#EXPERIENCE_SELECT_SEGMENT",
			value1 = "${segmentName}");

		Click(locator1 = "Button#SAVE");

		AssertClick(
			locator1 = "PageEditor#EXPERIENCE_BUTTON_NAME",
			value1 = "${experienceName}");

		AssertElementPresent(
			key_experienceName = "${experienceName}",
			locator1 = "PageEditor#EXPERIENCE_SELECT_ITEM");
	}

	macro addFragment {
		PageEditor.assertFragmentSidebarLoaded();

		PageEditor.gotoTab(tabName = "Fragments and Widgets");

		if (!(isSet(displayStyle))) {
			var displayStyle = "list";
		}

		if (IsElementNotPresent(key_displayStyle = "${displayStyle}", locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_DISPLAY_STYLE_BUTTON")) {
			Click(
				key_displayStyle = "",
				locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_DISPLAY_STYLE_BUTTON");
		}

		AssertVisible(
			key_displayStyle = "${displayStyle}",
			locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_DISPLAY_STYLE_BUTTON");

		Navigator.gotoNavTab(navTab = "Fragments");

		PageEditor.expandFragmentCollection(collectionName = "${collectionName}");

		if ("${displayStyle}" == "card") {
			if (("${scope}" == "Master") && ("${dropTarget}" == "Header")) {
				DragAndDrop.javaScriptDragAndDropToUp(
					key_collectionName = "${collectionName}",
					key_fragmentName = "${fragmentName}",
					locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_FRAGMENT_CARD_ITEM",
					locator2 = "PageEditor#HEADER_DROP_TARGET",
					value1 = "");
			}

			if (("${scope}" == "Master") && ("${dropTarget}" == "Footer")) {
				DragAndDrop.javaScriptDragAndDropToBottom(
					key_collectionName = "${collectionName}",
					key_fragmentName = "${fragmentName}",
					key_targetFragmentName = "Drop Zone",
					locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_FRAGMENT_CARD_ITEM",
					locator2 = "PageEditor#ANY_FRAGMENT_DROP_TARGET",
					value1 = "");
			}

			if ((isSet(targetFragmentName)) && ("${dropTarget}" == "Header")) {
				DragAndDrop.javaScriptDragAndDropToUp(
					key_collectionName = "${collectionName}",
					key_fragmentName = "${fragmentName}",
					key_targetFragmentName = "${targetFragmentName}",
					locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_FRAGMENT_CARD_ITEM",
					locator2 = "PageEditor#ANY_FRAGMENT_DROP_TARGET");
			}

			if ((isSet(targetFragmentName)) && (!(isSet(dropTarget)))) {
				DragAndDrop.javaScriptDragAndDropToBottom(
					key_collectionName = "${collectionName}",
					key_fragmentName = "${fragmentName}",
					key_targetFragmentName = "${targetFragmentName}",
					locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_FRAGMENT_CARD_ITEM",
					locator2 = "PageEditor#ANY_FRAGMENT_DROP_TARGET",
					value1 = "");
			}

			else {
				DragAndDrop.javaScriptDragAndDropToObject(
					key_collectionName = "${collectionName}",
					key_fragmentName = "${fragmentName}",
					locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_FRAGMENT_CARD_ITEM",
					locator2 = "PageEditor#FRAGMENT_DROP_TARGET",
					value1 = "");
			}
		}

		if ("${displayStyle}" == "list") {
			if (("${scope}" == "Master") && ("${dropTarget}" == "Header")) {
				DragAndDrop.javaScriptDragAndDropToUp(
					key_collectionName = "${collectionName}",
					key_fragmentName = "${fragmentName}",
					locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_FRAGMENT",
					locator2 = "PageEditor#HEADER_DROP_TARGET",
					value1 = "");
			}

			if (("${scope}" == "Master") && ("${dropTarget}" == "Footer")) {
				DragAndDrop.javaScriptDragAndDropToBottom(
					key_collectionName = "${collectionName}",
					key_fragmentName = "${fragmentName}",
					key_targetFragmentName = "Drop Zone",
					locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_FRAGMENT",
					locator2 = "PageEditor#ANY_FRAGMENT_DROP_TARGET",
					value1 = "");
			}

			if ((isSet(targetFragmentName)) && ("${dropTarget}" == "Header")) {
				DragAndDrop.javaScriptDragAndDropToUp(
					key_collectionName = "${collectionName}",
					key_fragmentName = "${fragmentName}",
					key_targetFragmentName = "${targetFragmentName}",
					locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_FRAGMENT",
					locator2 = "PageEditor#ANY_FRAGMENT_DROP_TARGET");
			}

			if ((isSet(targetFragmentName)) && (!(isSet(dropTarget)))) {
				DragAndDrop.javaScriptDragAndDropToBottom(
					key_collectionName = "${collectionName}",
					key_fragmentName = "${fragmentName}",
					key_targetFragmentName = "${targetFragmentName}",
					locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_FRAGMENT",
					locator2 = "PageEditor#ANY_FRAGMENT_DROP_TARGET",
					value1 = "");
			}

			else {
				DragAndDrop.javaScriptDragAndDropToObject(
					key_collectionName = "${collectionName}",
					key_fragmentName = "${fragmentName}",
					locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_FRAGMENT",
					locator2 = "PageEditor#FRAGMENT_DROP_TARGET",
					value1 = "");
			}
		}

		PageEditor.waitForAutoSave();

		if (!(isSet(position))) {
			var key_position = "1";
		}

		if (("${fragmentName}" == "Grid") || ("${fragmentName}" == "Container")) {
			AssertElementPresent(
				key_elementType = "${fragmentName}",
				key_position = "${position}",
				locator1 = "PageEditor#LAYOUT_ELEMENTS_HEADER");
		}

		if ("${fragmentName}" == "Collection Display") {
			AssertElementPresent(
				key_fragmentName = "${fragmentName}",
				key_message = "No Collection Selected Yet",
				locator1 = "Fragment#NOT_COLLECTION_SELECTED_MESSAGE");
		}

		if ("${fragmentName}" == "Content Display") {
			AssertElementPresent(
				key_fragmentName = "${fragmentName}",
				key_messageIfo = "The selected content will be shown here.",
				locator1 = "Fragment#MESSAGE_INFO");
		}

		if ("${fragmentName}" == "Display Page Content") {
			AssertElementPresent(
				key_fragmentName = "${fragmentName}",
				key_messageIfo = "The display page content will be shown here.",
				locator1 = "Fragment#MESSAGE_INFO");
		}

		if (isSet(composition)) {
			echo("## Adding a composition of fragments");
		}

		else {
			AssertElementPresent(
				key_fragmentName = "${fragmentName}",
				locator1 = "Fragment#FRAGMENT_HEADER");
		}
	}

	macro addFragmentToCollectionDisplay {
		PageEditor.assertFragmentSidebarLoaded();

		PageEditor.gotoTab(tabName = "Fragments and Widgets");

		if (!(isSet(displayStyle))) {
			var displayStyle = "list";
		}

		if (IsElementNotPresent(key_displayStyle = "${displayStyle}", locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_DISPLAY_STYLE_BUTTON")) {
			Click(
				key_displayStyle = "",
				locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_DISPLAY_STYLE_BUTTON");
		}

		AssertVisible(
			key_displayStyle = "${displayStyle}",
			locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_DISPLAY_STYLE_BUTTON");

		Navigator.gotoNavTab(navTab = "Fragments");

		PageEditor.expandFragmentCollection(collectionName = "${collectionName}");

		if ((isSet(targetFragmentName)) && ("${displayStyle}" == "card")) {
			DragAndDrop.javaScriptDragAndDropToBottom(
				key_collectionName = "${collectionName}",
				key_fragmentName = "${fragmentName}",
				key_targetFragmentName = "${targetFragmentName}",
				locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_FRAGMENT_CARD_ITEM",
				locator2 = "PageEditor#ANY_NESTED_FRAGMENT_DROP_TARGET",
				value1 = "");
		}

		if ((isSet(targetFragmentName)) && ("${displayStyle}" == "list")) {
			DragAndDrop.javaScriptDragAndDropToBottom(
				key_collectionName = "${collectionName}",
				key_fragmentName = "${fragmentName}",
				key_targetFragmentName = "${targetFragmentName}",
				locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_FRAGMENT",
				locator2 = "PageEditor#ANY_NESTED_FRAGMENT_DROP_TARGET",
				value1 = "");
		}

		if ((!(isSet(targetFragmentName))) && ("${displayStyle}" == "card")) {
			DragAndDrop.javaScriptDragAndDropToObject(
				key_collectionName = "${collectionName}",
				key_entryTitle = "${entryTitle}",
				key_fragmentName = "${fragmentName}",
				locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_FRAGMENT_CARD_ITEM",
				locator2 = "PageEditor#COLLECTION_CELL",
				value1 = "");
		}

		if ((!(isSet(targetFragmentName))) && ("${displayStyle}" == "list")) {
			DragAndDrop.javaScriptDragAndDropToObject(
				key_collectionName = "${collectionName}",
				key_entryTitle = "${entryTitle}",
				key_fragmentName = "${fragmentName}",
				locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_FRAGMENT",
				locator2 = "PageEditor#COLLECTION_CELL",
				value1 = "");
		}

		PageEditor.waitForAutoSave();
	}

	macro addVideoFragmentURL {
		FormFields.editText(
			fieldName = "url",
			fieldValue = "${videoLink}");

		Click(
			key_sidebarButton = "Selection",
			locator1 = "PageEditor#FRAGMENT_SIDEBAR_TITLE");

		PageEditor.waitForAutoSave();
	}

	macro addWidget {
		PageEditor.assertFragmentSidebarLoaded();

		PageEditor.gotoTab(tabName = "Fragments and Widgets");

		if (!(isSet(displayStyle))) {
			var displayStyle = "list";
		}

		if (IsElementNotPresent(key_displayStyle = "${displayStyle}", locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_DISPLAY_STYLE_BUTTON")) {
			Click(
				key_displayStyle = "",
				locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_DISPLAY_STYLE_BUTTON");
		}

		AssertVisible(
			key_displayStyle = "${displayStyle}",
			locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_DISPLAY_STYLE_BUTTON");

		Navigator.gotoNavTab(navTab = "Widgets");

		Type.sendKeysApplicationSearch(
			locator1 = "PageEditor#WIDGETS_APPLICATION_SEARCH_FIELD",
			value1 = "${portletName}");

		var key_portletName = "${portletName}";

		if ("${displayStyle}" == "card") {
			if ((isSet(scope)) && ("${dropTarget}" == "Header")) {
				DragAndDrop.javaScriptDragAndDropToUp(
					locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_WIDGET_CARD_ITEM",
					locator2 = "PageEditor#HEADER_DROP_TARGET",
					value1 = "");
			}

			if ((isSet(scope)) && ("${dropTarget}" == "Footer")) {
				DragAndDrop.javaScriptDragAndDropToBottom(
					key_targetFragmentName = "Drop Zone",
					locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_WIDGET_CARD_ITEM",
					locator2 = "PageEditor#ANY_FRAGMENT_DROP_TARGET",
					value1 = "");
			}

			if ((isSet(targetFragmentName)) && (isSet(collectionName))) {
				DragAndDrop.javaScriptDragAndDropToBottom(
					key_collectionName = "${collectionName}",
					key_fragmentName = "${portletName}",
					key_targetFragmentName = "${targetFragmentName}",
					locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_WIDGET_CARD_ITEM",
					locator2 = "PageEditor#ANY_FRAGMENT_DROP_TARGET",
					value1 = "");
			}

			if ((isSet(targetFragmentName)) && (!(isSet(collectionName)))) {
				DragAndDrop.javaScriptDragAndDropToBottom(
					key_targetFragmentName = "${targetFragmentName}",
					locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_WIDGET_CARD_ITEM",
					locator2 = "PageEditor#ANY_FRAGMENT_DROP_TARGET",
					value1 = "${portletName}");
			}

			else {
				DragAndDrop.javaScriptDragAndDropToObject(
					locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_WIDGET_CARD_ITEM",
					locator2 = "PageEditor#FRAGMENT_DROP_TARGET",
					value1 = "${portletName}");
			}
		}

		if ("${displayStyle}" == "list") {
			if ((isSet(scope)) && ("${dropTarget}" == "Header")) {
				DragAndDrop.javaScriptDragAndDropToUp(
					locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_WIDGET",
					locator2 = "PageEditor#HEADER_DROP_TARGET",
					value1 = "");
			}

			if ((isSet(scope)) && ("${dropTarget}" == "Footer")) {
				DragAndDrop.javaScriptDragAndDropToBottom(
					key_targetFragmentName = "Drop Zone",
					locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_WIDGET",
					locator2 = "PageEditor#ANY_FRAGMENT_DROP_TARGET",
					value1 = "");
			}

			if ((isSet(targetFragmentName)) && (isSet(collectionName))) {
				DragAndDrop.javaScriptDragAndDropToBottom(
					key_collectionName = "${collectionName}",
					key_fragmentName = "${portletName}",
					key_targetFragmentName = "${targetFragmentName}",
					locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_FRAGMENT",
					locator2 = "PageEditor#ANY_FRAGMENT_DROP_TARGET",
					value1 = "");
			}

			if ((isSet(targetFragmentName)) && (!(isSet(collectionName)))) {
				DragAndDrop.javaScriptDragAndDropToBottom(
					key_targetFragmentName = "${targetFragmentName}",
					locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_WIDGET",
					locator2 = "PageEditor#ANY_FRAGMENT_DROP_TARGET",
					value1 = "${portletName}");
			}

			else {
				DragAndDrop.javaScriptDragAndDropToObject(
					locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_WIDGET",
					locator2 = "PageEditor#FRAGMENT_DROP_TARGET",
					value1 = "${portletName}");
			}
		}

		PageEditor.waitForAutoSave();

		AssertElementPresent(
			key_fragmentName = "${portletName}",
			locator1 = "Fragment#FRAGMENT_HEADER");

		PageEditor.gotoTab(tabName = "Contents");

		PageEditor.gotoTab(tabName = "Fragments and Widgets");

		PageEditor.closeSidebar(tabName = "Fragments and Widgets");
	}

	macro assertAutoImageResolution {
		if ("${type}" == "backgroundImage") {
			var backgroundImage = Css.getCssValue(
				attribute = "background-image",
				element = "${element}");

			if (contains("${backgroundImage}", "${adaptiveMediaName}")) {
				echo("The auto image resolution is right.");
			}
			else {
				fail("The auto image resolution is wrong.");
			}
		}
		else {
			var currentSrc = selenium.getAttribute("${element}@currentSrc");

			if (contains("${currentSrc}", "${adaptiveMediaName}")) {
				echo("The auto image resolution is right.");
			}
			else {
				fail("The auto image resolution is wrong.");
			}
		}
	}

	macro assertFragmentSidebarLoaded {
		WaitForPageLoad();

		AssertVisible(locator1 = "PageEditor#FRAGMENT_SIDEBAR_LOADED");
	}

	macro changeExperience {
		var key_experienceName = "${newExperience}";

		Click(locator1 = "PageEditor#EXPERIENCE_LABEL");

		Click(locator1 = "PageEditor#EXPERIENCE_SELECT_ITEM");

		PageEditor.clickManagementBar();

		AssertElementPresent(locator1 = "PageEditor#EXPERIENCE_BUTTON_NAME");
	}

	macro changeExperienceLanguage {
		var key_experienceName = "${newExperience}";
		var key_language = "${language}";

		Click(locator1 = "PageEditor#EXPERIENCE_LABEL");

		Click(locator1 = "PageEditor#EXPERIENCE_SELECT_ITEM");

		PageEditor.clickManagementBar();

		AssertElementPresent(locator1 = "PageEditor#EXPERIENCE_BUTTON_NAME");

		Click(locator1 = "PageEditor#EXPERIENCE_LANGUAGE_SELECTOR");

		Click(locator1 = "PageEditor#EXPERIENCE_LANGUAGE_SELECTOR_LOCALE");
	}

	macro changeLocale {
		Click(
			key_currentLocale = StringUtil.lowerCase("${currentLocale}"),
			locator1 = "Button#TRANSLATIONS_LOCALIZATION");

		Click(
			key_locale = "${locale}",
			locator1 = "Translation#DROPDOWN_MENU_ITEM");

		AssertVisible(
			key_currentLocale = StringUtil.lowerCase("${locale}"),
			locator1 = "Button#TRANSLATIONS_LOCALIZATION");
	}

	macro clearSelection {
		Click(
			key_fieldLabel = "${fieldLabel}",
			key_text = "times-circle",
			locator1 = "Icon#ANY_ITEM_SELECTOR");

		PageEditor.waitForAutoSave();
	}

	macro clickBack {
		Click(locator1 = "Icon#ANGLE_LEFT_BACK");
	}

	macro clickConfigurableField {
		var key_fragmentName = "${fragmentName}";

		if (IsNotVisible(locator1 = "Fragment#FRAGMENT_HEADER")) {
			Click.clickNoWaitForVisible(locator1 = "Fragment#FRAGMENT_HEADER");
		}
	}

	macro clickDiscardDraft {
		WaitForPageLoad();

		Click(
			key_pageName = "${pageName}",
			locator1 = "SitePages#LIST_GROUP_ITEM_ELLIPSIS_ICON");

		MenuItem.clickNoError(menuItem = "Discard Draft");

		AssertConfirm(value1 = "Are you sure you want to discard current draft and apply latest published changes?");

		if (isSet(failure)) {
			if (IsElementPresent(locator1 = "Message#ERROR_2")) {
				Alert.viewRequestFailedToComplete();

				AssertTextEquals(
					locator1 = "Message#ERROR_2",
					value1 = "${failure}");
			}
			else {
				AssertTextEquals(
					locator1 = "Message#ERROR",
					value1 = "${failure}");
			}
		}
		else {
			Alert.viewSuccessMessage();
		}
	}

	macro clickEditableField {
		var key_fragmentName = "${fragmentName}";

		if (IsNotVisible(locator1 = "Fragment#FRAGMENT_HEADER")) {
			Click.clickNoWaitForVisible(locator1 = "Fragment#FRAGMENT_HEADER");
		}

		if ("${contributed}" == "false") {
			Click(locator1 = "Fragment#EDITABLE_FIELD");
		}
		else {
			Click(locator1 = "Fragment#CONTRIBUTED_FRAGMENT_EDITABLE_FIELD");
		}
	}

	macro clickManagementBar {
		var elementHeight = selenium.getElementHeight("PageEditor#FRAGMENT_SIDEBAR_BODY");
		var offSetY = MathUtil.product("25","${elementHeight}");
		var offSetY = MathUtil.quotient("${offSetY}","100");

		var elementWidth = selenium.getElementWidth("PageEditor#FRAGMENT_SIDEBAR_BODY");
		var offSetX = MathUtil.product("0","${elementWidth}");
		var offSetX = MathUtil.quotient("${offSetX}","100");

		Click.clickAt(
			locator1 = "PageEditor#FRAGMENT_SIDEBAR_BODY",
			value1 = "${offSetX},${offSetY}");
	}

	macro clickPublish {
		Button.click(button = "Publish");

		Alert.viewSuccessMessage();
	}

	macro closeSidebar {
		var key_tabName = "${tabName}";

		Click.clickNoMouseOver(locator1 = "PageEditor#FRAGMENT_SIDEBAR_TAB_BUTTON");

		AssertElementPresent(locator1 = "PageEditor#FRAGMENT_SIDEBAR_TAB_COLLAPSED");
	}

	macro configureFragment {
		if (isSet(alignment)) {
			Select(
				key_fieldLabel = "Text Align",
				locator1 = "Select#GENERIC_SELECT_FIELD",
				value1 = "${alignment}");

			Pause(locator1 = "3000");
		}

		if (isSet(backgroundColor)) {
			PageEditor.selectColorSwatchItem(
				colorSwatchItem = "${backgroundColor}",
				fieldLabel = "Background Color");

			Pause(locator1 = "3000");
		}

		if (isSet(borderColor)) {
			PageEditor.selectColorSwatchItem(
				colorSwatchItem = "${borderColor}",
				fieldLabel = "Border Color");

			Pause(locator1 = "3000");
		}

		if (isSet(borderRadius)) {
			Select(
				key_fieldLabel = "Border Radius",
				locator1 = "Select#GENERIC_SELECT_FIELD",
				value1 = "${borderRadius}");

			Pause(locator1 = "3000");
		}

		if (isSet(bottomSpacing)) {
			Select(
				key_fieldLabel = "Bottom Spacing",
				locator1 = "Select#GENERIC_SELECT_FIELD",
				value1 = "${bottomSpacing}");

			Pause(locator1 = "3000");
		}

		if (isSet(boxShadow)) {
			Select(
				key_fieldLabel = "Shadow",
				locator1 = "Select#GENERIC_SELECT_FIELD",
				value1 = "${boxShadow}");

			Pause(locator1 = "3000");
		}

		if (isSet(headingLevel)) {
			Select(
				key_fieldLabel = "Heading Level",
				locator1 = "Select#GENERIC_SELECT_FIELD",
				value1 = "${headingLevel}");

			Pause(locator1 = "3000");
		}

		if (isSet(height)) {
			Select(
				key_fieldLabel = "Height",
				locator1 = "PageEditor#CUSTOM_STYLES_SELECT_FIELD",
				value1 = "${height}");

			Pause(locator1 = "3000");
		}

		if (isSet(imageSize)) {
			Select(
				key_fieldLabel = "Image Size",
				locator1 = "Select#GENERIC_SELECT_FIELD",
				value1 = "${imageSize}");

			Pause(locator1 = "3000");
		}

		if (isSet(marginBottom)) {
			Select(
				key_borderBottom = "Margin",
				key_fieldLabel = "Bottom",
				locator1 = "Select#BORDER_BOTTOM_SELECT_FIELD",
				value1 = "${marginBottom}");

			Pause(locator1 = "3000");
		}

		if (isSet(marginLeft)) {
			Select(
				key_borderBottom = "Margin",
				key_fieldLabel = "Left",
				locator1 = "Select#BORDER_BOTTOM_SELECT_FIELD",
				value1 = "${marginLeft}");

			Pause(locator1 = "3000");
		}

		if (isSet(marginRight)) {
			Select(
				key_borderBottom = "Margin",
				key_fieldLabel = "Right",
				locator1 = "Select#BORDER_BOTTOM_SELECT_FIELD",
				value1 = "${marginRight}");

			Pause(locator1 = "3000");
		}

		if (isSet(marginTop)) {
			Select(
				key_borderBottom = "Margin",
				key_fieldLabel = "Top",
				locator1 = "Select#BORDER_BOTTOM_SELECT_FIELD",
				value1 = "${marginTop}");

			Pause(locator1 = "3000");
		}

		if (isSet(numberOfTabs)) {
			Type(
				key_fieldLabel = "Number Of Tabs",
				locator1 = "FormFields#NUMBER_FIELD",
				value1 = "${numberOfTabs}");

			Click(
				key_sidebarButton = "Selection",
				locator1 = "PageEditor#FRAGMENT_SIDEBAR_TITLE");

			AssertTextEquals(
				key_fieldLabel = "Number Of Tabs",
				locator1 = "FormFields#NUMBER_FIELD",
				value1 = "${numberOfTabs}");
		}

		if (isSet(paddingBottom)) {
			Select(
				key_borderBottom = "Padding",
				key_fieldLabel = "Bottom",
				locator1 = "Select#BORDER_BOTTOM_SELECT_FIELD",
				value1 = "${paddingBottom}");

			Pause(locator1 = "3000");
		}

		if (isSet(paddingLeft)) {
			Select(
				key_borderBottom = "Padding",
				key_fieldLabel = "Left",
				locator1 = "Select#BORDER_BOTTOM_SELECT_FIELD",
				value1 = "${paddingLeft}");

			Pause(locator1 = "3000");
		}

		if (isSet(paddingRight)) {
			Select(
				key_borderBottom = "Padding",
				key_fieldLabel = "Right",
				locator1 = "Select#BORDER_BOTTOM_SELECT_FIELD",
				value1 = "${paddingRight}");

			Pause(locator1 = "3000");
		}

		if (isSet(paddingTop)) {
			Select(
				key_borderBottom = "Padding",
				key_fieldLabel = "Top",
				locator1 = "Select#BORDER_BOTTOM_SELECT_FIELD",
				value1 = "${paddingTop}");

			Pause(locator1 = "3000");
		}

		if (isSet(separatorColor)) {
			Click(
				key_borderBottom = "Separator Color",
				key_paletteItem = "${separatorColor}",
				locator1 = "Button#BORDER_BOTTOM_PALETTE_ITEM");

			Pause(locator1 = "3000");
		}

		if (isSet(size)) {
			Select(
				key_fieldLabel = "Size",
				locator1 = "Select#GENERIC_SELECT_FIELD",
				value1 = "${size}");

			Pause(locator1 = "3000");
		}

		if (isSet(textColor)) {
			PageEditor.selectColorSwatchItem(
				colorSwatchItem = "${textColor}",
				fieldLabel = "Text Color");

			Pause(locator1 = "3000");
		}

		if (isSet(type)) {
			Select(
				key_fieldLabel = "Type",
				locator1 = "Select#GENERIC_SELECT_FIELD",
				value1 = "${type}");

			Pause(locator1 = "3000");
		}

		PageEditor.waitForAutoSave();
	}

	macro deleteComment {
		MouseOver(locator1 = "PageEditor#FRAGMENT_SIDEBAR_ELLIPSIS");

		Click(locator1 = "PageEditor#FRAGMENT_SIDEBAR_ELLIPSIS");

		AssertClickNoError(
			key_menuItem = "Delete",
			locator1 = "MenuItem#ANY_MENU_ITEM",
			value1 = "Delete");

		Click(locator1 = "Button#DELETE_FRAGMENT_COMMENT");

		AssertTextNotPresent(value1 = "${fragmentComment}");
	}

	macro deleteExperience {
		var key_experienceName = "${newExperience}";

		Click(locator1 = "PageEditor#EXPERIENCE_DEFAULT_BUTTON_NAME");

		ClickNoError(locator1 = "PageEditor#EXPERIENCE_DELETE_BUTTON");

		AssertConfirm(value1 = "Do you want to delete this experience? Its content will be deleted.");

		Alert.viewSuccessMessage();

		Click(locator1 = "PageEditor#EXPERIENCE_DEFAULT_BUTTON_NAME");

		AssertElementNotPresent(
			key_experienceName = "${newExperience}",
			locator1 = "PageEditor#EXPERIENCE_SELECT_ITEM");

		Click(locator1 = "PageEditor#EXPERIENCE_DEFAULT_BUTTON_NAME");
	}

	macro duplicateExperience {
		var key_experienceName = "${experienceName}";

		AssertTextEquals(
			locator1 = "PageEditor#EXPERIENCE_LABEL",
			value1 = "Experience");

		AssertClick(
			locator1 = "PageEditor#EXPERIENCE_BUTTON_NAME",
			value1 = "${experienceName}");

		Click(locator1 = "PageEditor#EXPERIENCE_DUPLICATE_BUTTON");

		AssertElementPresent(
			key_experienceName = "${experienceName} (Copy)",
			locator1 = "PageEditor#EXPERIENCE_SELECT_ITEM");
	}

	macro editCollectionCategoryFilter {
		var key_fragmentName = "${fragmentName}";

		if (isSet(columnNumber)) {
			Click.clickNoWaitForVisible(
				key_columnNumber = "${columnNumber}",
				key_elementHeader = "//li[contains(@class,'topper__title') and contains(.,'${key_fragmentName}')]",
				key_position = "1",
				locator1 = "PageEditor#GRID_COLUMN_NESTED_ELEMENT");
		}
		else {
			Click.clickNoWaitForVisible(locator1 = "Fragment#FRAGMENT_HEADER");
		}

		PageEditor.gotoTab(tabName = "Selection");

		AssertClick(
			key_navItem = "General",
			locator1 = "PageEditor#NAV_ITEM_BUTTON",
			value1 = "General");

		if (isSet(selectedName)) {
			AssertElementPresent(
				key_contentName = "${selectedName}",
				locator1 = "PageEditor#ITEM_SELECTOR_CONTENT_INPUT");
		}
		else {
			WaitForElementPresent(
				key_fieldLabel = "Source",
				locator1 = "PageEditor#ITEM_SELECTOR_CONTENT_INPUT_WITH_LABEL");

			var itemSelectorContentInputValue = selenium.getElementValue("//label[normalize-space(text())='Source']/following-sibling::div//input[contains(@class,'item-selector__content-input')]");

			if ("${itemSelectorContentInputValue}" == "") {
				Click(
					key_fieldLabel = "Source",
					key_text = "plus",
					locator1 = "Icon#ANY_ITEM_SELECTOR");
			}
			else {
				Click(
					key_fieldLabel = "Source",
					key_text = "change",
					locator1 = "Icon#ANY_ITEM_SELECTOR");
			}

			SelectFrame(locator1 = "IFrame#MODAL_BODY");

			LexiconTable.clickTableEntryColumnLink(
				columnName = "name",
				tableEntry = "${vocabularyName}");

			for (var category : list "${categoryNameList}") {
				AssertVisible(
					key_columnName = "name",
					key_tableEntry = "${category}",
					locator1 = "LexiconTable#TABLE_ENTRY_COLUMN_LINK");
			}

			if (isSet(categoryName)) {
				LexiconTable.clickTableEntryColumnLink(
					columnName = "name",
					tableEntry = "${categoryName}");

				for (var subcategory : list "${subcategoryNameList}") {
					AssertVisible(
						key_columnName = "name",
						key_tableEntry = "${subcategory}",
						locator1 = "LexiconTable#TABLE_ENTRY_COLUMN_LINK");
				}

				Button.click(button = "Select This Level");

				Pause(locator1 = "3000");

				AssertElementPresent(
					key_contentName = "${categoryName}",
					locator1 = "PageEditor#ITEM_SELECTOR_CONTENT_INPUT");
			}
			else {
				Button.click(button = "Select This Level");

				Pause(locator1 = "3000");

				AssertElementPresent(
					key_contentName = "${vocabularyName}",
					locator1 = "PageEditor#ITEM_SELECTOR_CONTENT_INPUT");
			}
		}

		if (isSet(singleSelection)) {
			while (IsNotChecked.isNotCheckedNotVisible(checkboxName = "Single Selection", locator1 = "Checkbox#ANY_CHECKBOX")) {
				Click.clickAtNotVisible(
					checkboxName = "Single Selection",
					locator1 = "Checkbox#ANY_CHECKBOX");
			}

			Pause(locator1 = "3000");

			AssertChecked.assertCheckedNotVisible(
				checkboxName = "Single Selection",
				locator1 = "Checkbox#ANY_CHECKBOX");
		}
	}

	macro editCollectionDisplay {
		if (!(isSet(index))) {
			var index = "1";
		}

		var key_fragmentName = "${fragmentName}";
		var key_index = "${index}";

		if (isSet(columnNumber)) {
			Click.clickNoWaitForVisible(
				key_columnNumber = "${columnNumber}",
				key_elementHeader = "//li[contains(@class,'topper__title') and contains(.,'${key_fragmentName}')]",
				key_position = "1",
				locator1 = "PageEditor#GRID_COLUMN_NESTED_ELEMENT");
		}
		else {
			Click.clickNoWaitForVisible(locator1 = "Fragment#FRAGMENT_HEADER_ANY");
		}

		PageEditor.gotoTab(tabName = "Selection");

		AssertClick(
			key_navItem = "General",
			locator1 = "PageEditor#NAV_ITEM_BUTTON",
			value1 = "General");

		if (isSet(selectedName)) {
			AssertElementPresent(
				key_contentName = "${selectedName}",
				locator1 = "PageEditor#ITEM_SELECTOR_CONTENT_INPUT");
		}
		else {
			WaitForElementPresent(
				key_fieldLabel = "Collection",
				locator1 = "PageEditor#ITEM_SELECTOR_CONTENT_INPUT_WITH_LABEL");

			var itemSelectorContentInputValue = selenium.getElementValue("//label[normalize-space(text())='Collection']/following-sibling::div//input[contains(@class,'item-selector__content-input')]");

			if ("${itemSelectorContentInputValue}" == "") {
				Click(
					key_fieldLabel = "Collection",
					key_text = "plus",
					locator1 = "Icon#ANY_ITEM_SELECTOR");
			}
			else {
				Click(
					key_fieldLabel = "Collection",
					key_text = "change",
					locator1 = "Icon#ANY_ITEM_SELECTOR");
			}

			SelectFrame(locator1 = "IFrame#MODAL_BODY");

			if (isSet(assetListName)) {
				NavItem.click(navItem = "Collections");

				LexiconCard.clickCard(card = "${assetListName}");

				AssertElementPresent(
					key_contentName = "${assetListName}",
					locator1 = "PageEditor#ITEM_SELECTOR_CONTENT_INPUT");
			}
			else if (isSet(infoListProviderName)) {
				NavItem.click(navItem = "Collection Providers");

				LexiconCard.clickCard(card = "${infoListProviderName}");

				AssertElementPresent(
					key_contentName = "${infoListProviderName}",
					locator1 = "PageEditor#ITEM_SELECTOR_CONTENT_INPUT");
			}
			else if (isSet(infoItemRelatedListProviderName)) {
				NavItem.click(navItem = "Related Items Collection Providers");

				LexiconCard.clickCard(card = "${infoItemRelatedListProviderName}");

				AssertElementPresent(
					key_contentName = "${infoItemRelatedListProviderName}",
					locator1 = "PageEditor#ITEM_SELECTOR_CONTENT_INPUT");
			}
		}

		if (isSet(layout)) {
			Select(
				key_fieldLabel = "Layout",
				locator1 = "Select#GENERIC_SELECT_FIELD",
				value1 = "${layout}");

			Pause(locator1 = "3000");

			AssertSelectedLabel(
				key_fieldLabel = "Layout",
				locator1 = "Select#GENERIC_SELECT_FIELD",
				value1 = "${layout}");
		}

		if (isSet(listStyle)) {
			AssertElementPresent(
				key_fieldLabel = "List Style",
				key_groupLabel = "Templates",
				key_value = "${listStyle}",
				locator1 = "Select#GROUPED_SELECT_VALUE");

			Select(
				key_fieldLabel = "List Style",
				locator1 = "Select#GENERIC_SELECT_FIELD",
				value1 = "${listStyle}");

			Pause(locator1 = "3000");

			AssertSelectedLabel(
				key_fieldLabel = "List Style",
				locator1 = "Select#GENERIC_SELECT_FIELD",
				value1 = "${listStyle}");

			if (isSet(listItemStyle)) {
				Select(
					key_fieldLabel = "List Item Style",
					locator1 = "Select#GENERIC_SELECT_FIELD",
					value1 = "${listItemStyle}");

				Pause(locator1 = "3000");

				AssertSelectedLabel(
					key_fieldLabel = "List Item Style",
					locator1 = "Select#GENERIC_SELECT_FIELD",
					value1 = "${listItemStyle}");
			}
		}

		if (isSet(maxNumberOfItems)) {
			Type(
				key_fieldLabel = "Max Number Of Items",
				locator1 = "FormFields#NUMBER_FIELD",
				value1 = "${maxNumberOfItems}");

			Click(
				key_sidebarButton = "Selection",
				locator1 = "PageEditor#FRAGMENT_SIDEBAR_TITLE");

			AssertTextEquals(
				key_fieldLabel = "Max Number Of Items",
				locator1 = "FormFields#NUMBER_FIELD",
				value1 = "${maxNumberOfItems}");
		}

		PageEditor.waitForAutoSave();
	}

	macro editComment {
		MouseOver(locator1 = "PageEditor#FRAGMENT_SIDEBAR_ELLIPSIS");

		Click(locator1 = "PageEditor#FRAGMENT_SIDEBAR_ELLIPSIS");

		MenuItem.click(menuItem = "Edit");

		Click.clickAt(locator1 = "PageEditor#FRAGMENT_SIDEBAR_COMMENTS_EDITOR");

		Type(
			locator1 = "PageEditor#FRAGMENT_SIDEBAR_COMMENTS_EDITOR",
			value1 = "${fragmentCommentEdit}");

		Click(locator1 = "Button#UPDATE");
	}

	macro editContentDisplay {
		var key_fragmentName = "${fragmentName}";

		if (IsNotVisible(locator1 = "Fragment#FRAGMENT_HEADER")) {
			Click.clickNoWaitForVisible(locator1 = "Fragment#FRAGMENT_HEADER");
		}

		PageEditor.gotoTab(tabName = "Selection");

		AssertClick(
			key_navItem = "General",
			locator1 = "PageEditor#NAV_ITEM_BUTTON",
			value1 = "General");

		if (isSet(inCollectionDisplay)) {
			Select(
				key_fieldLabel = "Template",
				locator1 = "Select#GENERIC_SELECT_FIELD",
				value1 = "${templateOption}");

			Pause(locator1 = "3000");

			AssertSelectedLabel(
				key_fieldLabel = "Template",
				locator1 = "Select#GENERIC_SELECT_FIELD",
				value1 = "${templateOption}");
		}
		else {
			WaitForElementPresent(
				key_fieldLabel = "Item",
				locator1 = "PageEditor#ITEM_SELECTOR_CONTENT_INPUT_WITH_LABEL");

			var itemSelectorContentInputValue = selenium.getElementValue("//label[normalize-space(text())='Item']/following-sibling::div//input[contains(@class,'item-selector__content-input')]");

			if ("${itemSelectorContentInputValue}" == "") {
				Click(
					key_fieldLabel = "Item",
					key_text = "plus",
					locator1 = "Icon#ANY_ITEM_SELECTOR");
			}
			else {
				Click(
					key_fieldLabel = "Item",
					key_text = "change",
					locator1 = "Icon#ANY_ITEM_SELECTOR");
			}

			if (IsElementPresent(key_menuItem = "Select Item...",locator1 = "MenuItem#ANY_MENU_ITEM")) {
				MenuItem.click(menuItem = "Select Item...");
			}

			SelectFrame(locator1 = "IFrame#MODAL_BODY");

			if (isSet(documentandmedia)) {
				NavItem.click(navItem = "Documents and Media");

				LexiconCard.clickCard(card = "${imageFileName}");

				AssertElementPresent(
					key_contentName = "${imageFileName}",
					locator1 = "PageEditor#ITEM_SELECTOR_CONTENT_INPUT");

				AssertElementPresent(
					key_fragmentName = "${fragmentName}",
					key_imageName = "${sourceFileName}",
					locator1 = "Fragment#FRAGMENT_CONTENT_BACKGROUND_IMAGE");
			}

			if (isSet(blogs)) {
				NavItem.click(navItem = "Blogs");

				LexiconCard.clickCard(card = "${entryTitle}");

				AssertElementPresent(
					key_contentName = "${entryTitle}",
					locator1 = "PageEditor#ITEM_SELECTOR_CONTENT_INPUT");

				AssertTextEquals(
					locator1 = "Fragment#FRAGMENT_BODY",
					value1 = "${entryContent}");
			}

			if (isSet(categories)) {
				NavItem.click(navItem = "Categories");

				Portlet.expandTree();

				AssertVisible(
					key_nodeName = "${assetTitle}",
					locator1 = "Treeview#NODE_ITEM");

				Click(
					key_nodeName = "${assetTitle}",
					locator1 = "Treeview#NODE_UNSELECTED");
			}

			if (isSet(webcontent)) {
				NavItem.click(navItem = "Web Content");

				if (isSet(depotName)) {
					var key_contentName = "${webContentTitle}";

					AssertClick(
						key_breadcrumbName = "Sites and Libraries",
						locator1 = "Breadcrumb#BREADCRUMB_ENTRY",
						value1 = "Sites and Libraries");

					AssertClick(
						key_groupTab = "Asset Library",
						locator1 = "ItemSelector#NAVIGATION_GROUP_TAB",
						value1 = "Asset Library");

					LexiconCard.clickCard(card = "${depotName}");

					Click(locator1 = "ItemSelector#SELECT_FILE_WEB_CONTENT");
				}

				else {
					LexiconEntry.changeDisplayStyle(displayStyle = "cards");

					LexiconCard.clickCard(card = "${webContentTitle}");
				}

				if (isSet(customWebcontenttemplate)) {
					Select(
						locator1 = "FragmentEditor#FRAGMENTS_EDITOR_FLOATING_TOOLBAR_FIELD_SELECT",
						value1 = "${customWebcontenttemplate}");

					AssertElementPresent(
						key_contentName = "${webContentTitle}",
						locator1 = "PageEditor#ITEM_SELECTOR_CONTENT_INPUT");

					AssertElementPresent(
						key_contentName = "${customWebcontenttemplate}",
						locator1 = "FragmentEditor#FRAGMENTS_EDITOR_FLOATING_TOOLBAR_FIELD_SELECT");

					if (isSet(webContentContent)) {
						AssertTextEquals(
							locator1 = "Fragment#FRAGMENT_BODY",
							value1 = "${webContentContent}");
					}
				}
				else {
					AssertElementPresent(
						key_contentName = "${webContentTitle}",
						locator1 = "PageEditor#ITEM_SELECTOR_CONTENT_INPUT");

					if (isSet(webContentContent)) {
						AssertTextEquals(
							locator1 = "Fragment#FRAGMENT_BODY",
							value1 = "${webContentContent}");
					}
				}
			}
		}
	}

	macro editDropdown {
		var key_fragmentName = "Dropdown";

		if (IsNotVisible(locator1 = "Fragment#FRAGMENT_HEADER")) {
			Click.clickNoWaitForVisible(locator1 = "Fragment#FRAGMENT_HEADER");
		}

		AssertVisible(
			key_sidebarButton = "Selection",
			locator1 = "PageEditor#FRAGMENT_SIDEBAR_TITLE");

		if ("${panel}" == "General") {
			AssertClick(
				key_navItem = "General",
				locator1 = "PageEditor#NAV_ITEM_BUTTON",
				value1 = "General");

			if (isSet(displayedBehavior)) {
				while (IsNotChecked.isNotCheckedNotVisible(checkboxName = "${displayedBehavior}", locator1 = "Checkbox#ANY_CHECKBOX")) {
					Click.clickAtNotVisible(
						checkboxName = "${displayedBehavior}",
						locator1 = "Checkbox#ANY_CHECKBOX");
				}

				Pause(locator1 = "3000");

				AssertChecked.assertCheckedNotVisible(
					checkboxName = "${displayedBehavior}",
					locator1 = "Checkbox#ANY_CHECKBOX");
			}

			if (isSet(panelType)) {
				Select(
					key_fieldLabel = "Panel Type",
					locator1 = "Select#GENERIC_SELECT_FIELD",
					value1 = "${panelType}");

				Pause(locator1 = "3000");

				AssertSelectedLabel(
					key_fieldLabel = "Panel Type",
					locator1 = "Select#GENERIC_SELECT_FIELD",
					value1 = "${panelType}");
			}
		}

		PageEditor.waitForAutoSave();
	}

	macro editExperience {
		var key_experienceName = "${newExperience}";

		Click(locator1 = "PageEditor#EXPERIENCE_DEFAULT_BUTTON_NAME");

		Click(locator1 = "PageEditor#EXPERIENCE_EDIT_BUTTON");

		Click(locator1 = "PageEditor#EXPERIENCE_CREATE_SEGMENT");

		Segmentation.addProperties(propertyOption = "Email Address");

		Segmentation.fillTitle(titleField = "AddSegmentUserEmailAddressContains Test 2");

		Segmentation.changeCriterionInput(criterionInputOption = "Contains");

		Segmentation.fillProperty(propertyField = "liferay2");

		Button.clickSave();

		Type(
			locator1 = "PageEditor#EXPERIENCE_NAME",
			value1 = "${key_experienceName}");

		Click(locator1 = "Button#SAVE");

		Click(locator1 = "PageEditor#EXPERIENCE_DEFAULT_BUTTON_NAME");

		AssertElementPresent(
			key_experienceName = "${newExperience}",
			locator1 = "PageEditor#EXPERIENCE_SELECT_ITEM");

		Click(locator1 = "PageEditor#EXPERIENCE_DEFAULT_BUTTON_NAME");
	}

	macro editFragmentHTML {
		PageEditor.gotoEditableFieldEdit(
			contributed = "${contributed}",
			fragmentName = "${fragmentName}",
			id = "${editableId}");

		if (isSet(fileName)) {
			var content = TestCase.getFileContent(fileName = "${fileName}");
		}

		Type.typeAceEditorNoError(
			locator1 = "Fragment#EDITABLE_HTML_FRAGMENT_FIELD",
			value1 = "${content}");

		Click.pauseClickAt(locator1 = "//button[normalize-space(text())='Save']");

		PageEditor.waitForAutoSave();
	}

	macro editFragmentImage {
		if (contains("${fragmentName}", "Banner")) {
			PageEditor.clickConfigurableField(fragmentName = "${fragmentName}");

			var elementHeight = selenium.getElementHeight("//div[contains(@class,'page-editor__topper__bar') and contains(.,'${fragmentName}')]//following-sibling::div[contains(@class,'page-editor__topper__content')]//div[contains(@data-lfr-background-image-id,'${id}')]");
			var offSetY = MathUtil.product("25","${elementHeight}");
			var offSetY = MathUtil.quotient("${offSetY}","100");

			var elementWidth = selenium.getElementWidth("//div[contains(@class,'page-editor__topper__bar') and contains(.,'${fragmentName}')]//following-sibling::div[contains(@class,'page-editor__topper__content')]//div[contains(@data-lfr-background-image-id,'${id}')]");
			var offSetX = MathUtil.product("50","${elementWidth}");
			var offSetX = MathUtil.quotient("${offSetX}","100");

			Click.clickAt(
				id = "${id}",
				key_fragmentName = "${fragmentName}",
				locator1 = "Fragment#BACKGROUND_IMAGE_EDITABLE_FIELD",
				value1 = "${offSetX},${offSetY}");
		}
		else {
			PageEditor.clickEditableField(
				contributed = "${contributed}",
				fragmentName = "${fragmentName}",
				id = "${id}");
		}

		PageEditor.gotoTab(tabName = "Selection");

		AssertClick(
			key_navItem = "Image Source",
			locator1 = "PageEditor#NAV_ITEM_BUTTON",
			value1 = "Image Source");

		Pause(locator1 = "3000");

		if (!(IsSelectedLabel(key_fieldLabel = "Source Selection", locator1 = "Select#GENERIC_SELECT_FIELD", value1 = "Direct"))) {
			Select(
				key_fieldLabel = "Source Selection",
				locator1 = "Select#GENERIC_SELECT_FIELD",
				value1 = "Direct");

			AssertSelectedLabel(
				key_fieldLabel = "Source Selection",
				locator1 = "Select#GENERIC_SELECT_FIELD",
				value1 = "Direct");
		}

		WaitForElementPresent(
			key_fieldLabel = "Image",
			locator1 = "PageEditor#ITEM_SELECTOR_CONTENT_INPUT_WITH_LABEL");

		var itemSelectorContentInputValue = selenium.getElementValue("//label[normalize-space(text())='Image']/following-sibling::div//input[contains(@class,'item-selector__content-input')]");

		if ("${itemSelectorContentInputValue}" == "") {
			Click(
				key_fieldLabel = "Image",
				key_text = "plus",
				locator1 = "Icon#ANY_ITEM_SELECTOR");
		}
		else {
			Click(
				key_fieldLabel = "Image",
				key_text = "change",
				locator1 = "Icon#ANY_ITEM_SELECTOR");
		}

		if (isSet(imageFileName)) {
			ItemSelector.selectDMImage(
				imageFileName = "${imageFileName}",
				navTab = "Documents and Media");
		}
		else if (isSet(imageSourceURL)) {
			ItemSelector.addImageFromURL(
				imageSourceURL = "${imageSourceURL}",
				navTab = "URL");
		}
		else {
			SelectFrame(locator1 = "IFrame#MODAL_BODY");

			AssertElementPresent.assertVisible(locator1 = "Button#SELECT_FILE");

			UploadCommonFile.uploadCommonFileHiddenNoMouseOver(
				locator1 = "TextInput#FILE",
				value1 = "${fileName}");

			Pause(locator1 = "3000");

			Button.clickAdd();
		}

		PageEditor.waitForAutoSave();

		if (isSet(imageDescription)) {
			Pause(locator1 = "3000");

			Type(
				locator1 = "TextInput#IMAGE_DESCRIPTION",
				value1 = "${imageDescription}");

			Pause(locator1 = "3000");

			AssertTextEquals.assertValue(
				locator1 = "TextInput#IMAGE_DESCRIPTION",
				value1 = "${imageDescription}");

			Click(
				key_sidebarButton = "Selection",
				locator1 = "PageEditor#FRAGMENT_SIDEBAR_TITLE");

			PageEditor.waitForAutoSave();
		}
	}

	macro editFragmentText {
		PageEditor.gotoEditableFieldEdit(
			contributed = "${contributed}",
			fragmentName = "${fragmentName}",
			id = "${id}");

		if (isSet(text)) {
			Type(
				key_editor = "content",
				locator1 = "AlloyEditor#EDITOR",
				value1 = "${text}");
		}

		if (isSet(style)) {
			SelectFieldText(
				key_editor = "content",
				locator1 = "AlloyEditor#EDITOR");

			Click(locator1 = "AlloyEditor#TEXT_FORMATTING_STYLE");

			Click(
				key_styleFormat = "${style}",
				locator1 = "AlloyEditor#TEXT_FORMATTING_STYLE_DROPDOWN");
		}

		PageEditor.clickManagementBar();

		PageEditor.waitForAutoSave();
	}

	macro editLayoutContainer {
		var key_elementType = "Container";

		if (!(isSet(position))) {
			var key_position = "1";
		}
		else {
			var key_position = "${position}";
		}

		if (IsNotVisible(locator1 = "PageEditor#LAYOUT_ELEMENTS_HEADER")) {
			Click.clickNoWaitForVisible(locator1 = "PageEditor#LAYOUT_ELEMENTS_HEADER");
		}

		PageEditor.gotoTab(tabName = "Selection");

		if ("${panel}" == "Styles") {
			AssertClick(
				key_navItem = "Styles",
				locator1 = "PageEditor#NAV_ITEM_BUTTON",
				value1 = "Styles");

			if (isSet(backgroundColor)) {
				PageEditor.selectColorSwatchItem(
					colorSwatchItem = "${backgroundColor}",
					fieldLabel = "Background Color");

				Pause(locator1 = "3000");
			}

			if (isSet(backgroundImage)) {
				Select(
					key_fieldLabel = "Image Source",
					locator1 = "Select#GENERIC_SELECT_FIELD",
					value1 = "${backgroundImage}");

				if ("${backgroundImage}" == "Mapping") {
					if (isSet(entryTitle)) {
						PageEditorMapping.mapEditableFieldToAsset(
							entryTitle = "${entryTitle}",
							navItem = "${navItem}",
							uploadFileName = "${uploadFileName}");

						if ("${navItem}" == "Documents and Media") {
							Select(
								locator1 = "PageEditorEditableLink#LAYOUT_BACKGROUND_IMAGE_FIELD",
								value1 = "${fieldName}");
						}
						else {
							Select(
								locator1 = "PageEditorEditableLink#LAYOUT_BACKGROUND_IMAGE_FIELD",
								value1 = "Image");
						}

						SelectFrame(value1 = "relative=top");
					}
					else {
						if (isSet(source)) {
							Select(
								key_fieldLabel = "Source",
								locator1 = "Select#GENERIC_SELECT_FIELD",
								value1 = "${source}");
						}

						Pause(locator1 = "3000");

						Select(
							key_fieldLabel = "Field",
							locator1 = "Select#GENERIC_SELECT_FIELD",
							value1 = "${fieldName}");
					}
				}

				if ("${backgroundImage}" == "Direct") {
					WaitForElementPresent(
						key_fieldLabel = "Background Image",
						locator1 = "PageEditor#ITEM_SELECTOR_CONTENT_INPUT_WITH_LABEL");

					var itemSelectorContentInputValue = selenium.getElementValue("//label[normalize-space(text())='Background Image']/following-sibling::div//input[contains(@class,'item-selector__content-input')]");

					if ("${itemSelectorContentInputValue}" == "") {
						Click(
							key_fieldLabel = "Background Image",
							key_text = "plus",
							locator1 = "Icon#ANY_ITEM_SELECTOR");
					}
					else {
						Click(
							key_fieldLabel = "Background Image",
							key_text = "change",
							locator1 = "Icon#ANY_ITEM_SELECTOR");
					}

					if (isSet(depotName)) {
						ItemSelector.selectRepositoryImage(
							depotName = "${depotName}",
							imageFileName = "${imageFileName}",
							navTab = "Documents and Media");
					}

					else {
						if (isSet(uploadFileName)) {
							ItemSelector.uploadFile(
								navTab = "Documents and Media",
								uploadFileName = "${uploadFileName}");
						}
						else if (isSet(imageSourceURL)) {
							ItemSelector.addImageFromURL(
								imageSourceURL = "${imageSourceURL}",
								navTab = "URL");
						}
						else {
							SelectFrame(locator1 = "ItemSelector#ITEM_SELECTOR_IFRAME");

							Click(
								key_card = "${entryTitle}",
								locator1 = "Card#CARD_TITLE");
						}
					}

					SelectFrame(value1 = "relative=top");
				}

				Pause(locator1 = "3000");
			}

			if (isSet(borderColor)) {
				PageEditor.selectColorSwatchItem(
					colorSwatchItem = "${borderColor}",
					fieldLabel = "Border Color");

				Pause(locator1 = "3000");
			}

			if (isSet(borderRadius)) {
				Select(
					key_fieldLabel = "Border Radius",
					locator1 = "Select#GENERIC_SELECT_FIELD",
					value1 = "${borderRadius}");

				Pause(locator1 = "3000");
			}

			if (isSet(borderWidth)) {
				Type(
					key_fieldLabel = "Border Width",
					locator1 = "FormFields#NUMBER_FIELD",
					value1 = "${borderWidth}");

				AssertTextEquals(
					key_fieldLabel = "Border Width",
					locator1 = "FormFields#NUMBER_FIELD",
					value1 = "${borderWidth}");

				Click(
					key_sidebarButton = "Selection",
					locator1 = "PageEditor#FRAGMENT_SIDEBAR_TITLE");

				Pause(locator1 = "3000");
			}

			if (isSet(boxShadow)) {
				Select(
					key_fieldLabel = "Shadow",
					locator1 = "Select#GENERIC_SELECT_FIELD",
					value1 = "${boxShadow}");

				Pause(locator1 = "3000");
			}

			if (isSet(containerWidth)) {
				Select(
					key_fieldLabel = "Container Width",
					locator1 = "Select#GENERIC_SELECT_FIELD",
					value1 = "${containerWidth}");

				Pause(locator1 = "3000");
			}

			if (isSet(contentDisplay)) {
				Select(
					key_fieldLabel = "Content Display",
					locator1 = "Select#GENERIC_SELECT_FIELD",
					value1 = "${contentDisplay}");

				Pause(locator1 = "3000");

				if ("${contentDisplay}" != "Block") {
					if (isSet(alignItems)) {
						Select(
							key_fieldLabel = "Align Items",
							locator1 = "Select#GENERIC_SELECT_FIELD",
							value1 = "${alignItems}");

						Pause(locator1 = "3000");
					}

					if (isSet(justifyContent)) {
						Select(
							key_fieldLabel = "Justify Content",
							locator1 = "Select#GENERIC_SELECT_FIELD",
							value1 = "${justifyContent}");

						Pause(locator1 = "3000");
					}
				}
			}

			if (isSet(height)) {
				Type(
					key_borderBottom = "Size",
					key_fieldLabel = "Height",
					locator1 = "TextInput#BORDER_BOTTOM_INPUT_FIELD",
					value1 = "${height}");

				Click(
					key_sidebarButton = "Selection",
					locator1 = "PageEditor#FRAGMENT_SIDEBAR_TITLE");
			}

			if (isSet(marginBottom)) {
				Select(
					key_borderBottom = "Margin",
					key_fieldLabel = "Bottom",
					locator1 = "Select#BORDER_BOTTOM_SELECT_FIELD",
					value1 = "${marginBottom}");

				Pause(locator1 = "3000");
			}

			if (isSet(marginLeft)) {
				Select(
					key_borderBottom = "Margin",
					key_fieldLabel = "Left",
					locator1 = "Select#BORDER_BOTTOM_SELECT_FIELD",
					value1 = "${marginLeft}");

				Pause(locator1 = "3000");
			}

			if (isSet(marginRight)) {
				Select(
					key_borderBottom = "Margin",
					key_fieldLabel = "Right",
					locator1 = "Select#BORDER_BOTTOM_SELECT_FIELD",
					value1 = "${marginRight}");

				Pause(locator1 = "3000");
			}

			if (isSet(marginTop)) {
				Select(
					key_borderBottom = "Margin",
					key_fieldLabel = "Top",
					locator1 = "Select#BORDER_BOTTOM_SELECT_FIELD",
					value1 = "${marginTop}");

				Pause(locator1 = "3000");
			}

			if (isSet(opacity)) {
				Type(
					key_fieldLabel = "Opacity",
					locator1 = "FormFields#NUMBER_FIELD",
					value1 = "${opacity}");

				AssertTextEquals(
					key_fieldLabel = "Opacity",
					locator1 = "FormFields#NUMBER_FIELD",
					value1 = "${opacity}");

				Click(
					key_sidebarButton = "Selection",
					locator1 = "PageEditor#FRAGMENT_SIDEBAR_TITLE");

				Pause(locator1 = "3000");
			}

			if (isSet(paddingBottom)) {
				Select(
					key_borderBottom = "Padding",
					key_fieldLabel = "Bottom",
					locator1 = "Select#BORDER_BOTTOM_SELECT_FIELD",
					value1 = "${paddingBottom}");

				Pause(locator1 = "3000");
			}

			if (isSet(paddingLeft)) {
				Select(
					key_borderBottom = "Padding",
					key_fieldLabel = "Left",
					locator1 = "Select#BORDER_BOTTOM_SELECT_FIELD",
					value1 = "${paddingLeft}");

				Pause(locator1 = "3000");
			}

			if (isSet(paddingRight)) {
				Select(
					key_borderBottom = "Padding",
					key_fieldLabel = "Right",
					locator1 = "Select#BORDER_BOTTOM_SELECT_FIELD",
					value1 = "${paddingRight}");

				Pause(locator1 = "3000");
			}

			if (isSet(paddingTop)) {
				Select(
					key_borderBottom = "Padding",
					key_fieldLabel = "Top",
					locator1 = "Select#BORDER_BOTTOM_SELECT_FIELD",
					value1 = "${paddingTop}");

				Pause(locator1 = "3000");
			}
		}

		if ("${panel}" == "General") {
			AssertClick(
				key_navItem = "General",
				locator1 = "PageEditor#NAV_ITEM_BUTTON",
				value1 = "General");

			if ("${link}" == "Mapped URL") {
				Select(
					key_fieldLabel = "Link",
					locator1 = "Select#GENERIC_SELECT_FIELD",
					value1 = "${link}");

				Pause(locator1 = "3000");

				PageEditorMapping.mapEditableFieldToAsset(
					entryTitle = "${entryTitle}",
					navItem = "${navItem}");

				Select(
					key_fieldLabel = "Field",
					locator1 = "Select#GENERIC_SELECT_FIELD",
					value1 = "${field}");

				PageEditor.waitForAutoSave();

				AssertSelectedLabel(
					key_fieldLabel = "Field",
					locator1 = "Select#GENERIC_SELECT_FIELD",
					value1 = "${field}");
			}
			else {
				Type(
					locator1 = "PageEditorEditableLink#URL",
					value1 = "${url}");

				Click(
					key_sidebarButton = "Selection",
					locator1 = "PageEditor#FRAGMENT_SIDEBAR_TITLE");
			}

			if ("${target}" == "Blank") {
				while (IsNotChecked.isNotCheckedNotVisible(checkboxName = "Open in a new tab.", locator1 = "Checkbox#ANY_CHECKBOX")) {
					Click.clickAtNotVisible(
						checkboxName = "Open in a new tab.",
						locator1 = "Checkbox#ANY_CHECKBOX");
				}

				Pause(locator1 = "3000");
			}
			else if ("${target}" == "Self") {
				while (IsChecked.isNotCheckedNotVisible(checkboxName = "Open in a new tab.", locator1 = "Checkbox#ANY_CHECKBOX")) {
					Click.clickAtNotVisible(
						checkboxName = "Open in a new tab.",
						locator1 = "Checkbox#ANY_CHECKBOX");
				}

				Pause(locator1 = "3000");
			}
		}

		PageEditor.waitForAutoSave();
	}

	macro editLayoutGrid {
		var key_elementType = "Grid";
		var key_position = "1";

		if (IsNotVisible(locator1 = "PageEditor#LAYOUT_ELEMENTS_HEADER")) {
			Click.clickNoWaitForVisible(locator1 = "PageEditor#LAYOUT_ELEMENTS_HEADER");
		}

		PageEditor.gotoTab(tabName = "Selection");

		if ("${panel}" == "General") {
			AssertClick(
				key_navItem = "General",
				locator1 = "PageEditor#NAV_ITEM_BUTTON",
				value1 = "General");

			if (isSet(columnCount)) {
				Select(
					key_fieldLabel = "Number of Modules",
					locator1 = "Select#GENERIC_SELECT_FIELD",
					value1 = "${columnCount}");

				Pause(locator1 = "3000");
			}

			if ("${spaceBetweenColumns}" == "true") {
				while (IsNotChecked.isNotCheckedNotVisible(checkboxName = "Show Gutter", locator1 = "Checkbox#ANY_CHECKBOX")) {
					Click.clickAtNotVisible(
						checkboxName = "Show Gutter",
						locator1 = "Checkbox#ANY_CHECKBOX");
				}
			}

			if ("${spaceBetweenColumns}" == "false") {
				while (IsChecked(checkboxName = "Show Gutter", locator1 = "Checkbox#ANY_CHECKBOX")) {
					Click.clickAtNotVisible(
						checkboxName = "Show Gutter",
						locator1 = "Checkbox#ANY_CHECKBOX");
				}
			}
		}
		else if ("${panel}" == "Styles") {
			AssertClick(
				key_navItem = "Styles",
				locator1 = "PageEditor#NAV_ITEM_BUTTON",
				value1 = "Styles");

			if (isSet(layout)) {
				Select(
					key_fieldLabel = "Layout",
					locator1 = "Select#GENERIC_SELECT_FIELD",
					value1 = "${layout}");

				Pause(locator1 = "3000");
			}

			if (isSet(verticalAlignment)) {
				Select(
					key_fieldLabel = "Vertical Alignment",
					locator1 = "Select#GENERIC_SELECT_FIELD",
					value1 = "${verticalAlignment}");

				Pause(locator1 = "3000");
			}

			if ("${inverseOrder}" == "true") {
				if (IsNotChecked.isNotCheckedNotVisible(checkboxName = "Inverse order", locator1 = "Checkbox#ANY_CHECKBOX")) {
					Click.clickAtNotVisible(
						key_fieldLabel = "Inverse order",
						locator1 = "Checkbox#CHECKBOX_LABEL");
				}

				Pause(locator1 = "3000");
			}

			if ("${inverseOrder}" == "false") {
				if (IsChecked(checkboxName = "Inverse order", locator1 = "Checkbox#ANY_CHECKBOX")) {
					Click.clickAtNotVisible(
						key_fieldLabel = "Inverse order",
						locator1 = "Checkbox#CHECKBOX_LABEL");
				}

				Pause(locator1 = "3000");
			}
		}

		PageEditor.waitForAutoSave();
	}

	macro editMenuDisplay {
		var key_fragmentName = "Menu Display";

		if (IsNotVisible(locator1 = "Fragment#FRAGMENT_HEADER")) {
			Click.clickNoWaitForVisible(locator1 = "Fragment#FRAGMENT_HEADER");
		}

		AssertVisible(
			key_sidebarButton = "Selection",
			locator1 = "PageEditor#FRAGMENT_SIDEBAR_TITLE");

		if ("${panel}" == "General") {
			AssertClick(
				key_navItem = "General",
				locator1 = "PageEditor#NAV_ITEM_BUTTON",
				value1 = "General");

			if (isSet(siteMenus)) {
				Click(
					key_fieldLabel = "Source",
					key_text = "change",
					locator1 = "Icon#ANY_ITEM_SELECTOR");

				SelectFrame(locator1 = "IFrame#MODAL_BODY");

				NavItem.click(navItem = "Site Menus");

				LexiconTable.clickTableEntryColumnLink(
					columnName = "name",
					tableEntry = "${siteMenus}");

				Button.click(button = "Select This Level");

				Pause(locator1 = "3000");

				AssertElementPresent(
					key_contentName = "${siteMenus}",
					locator1 = "PageEditor#ITEM_SELECTOR_CONTENT_INPUT");
			}

			if (isSet(displayStyle)) {
				Select(
					key_fieldLabel = "Display Style",
					locator1 = "Select#GENERIC_SELECT_FIELD",
					value1 = "${displayStyle}");

				Pause(locator1 = "3000");

				AssertSelectedLabel(
					key_fieldLabel = "Display Style",
					locator1 = "Select#GENERIC_SELECT_FIELD",
					value1 = "${displayStyle}");
			}

			if (isSet(sublevels)) {
				Select(
					key_fieldLabel = "Sublevels",
					locator1 = "Select#GENERIC_SELECT_FIELD",
					value1 = "${sublevels}");

				Pause(locator1 = "3000");

				AssertSelectedLabel(
					key_fieldLabel = "Sublevels",
					locator1 = "Select#GENERIC_SELECT_FIELD",
					value1 = "${sublevels}");
			}
		}
		else if ("${panel}" == "Styles") {
			AssertClick(
				key_navItem = "Styles",
				locator1 = "PageEditor#NAV_ITEM_BUTTON",
				value1 = "Styles");

			if (isSet(hoveredItemColor)) {
				PageEditor.selectColorSwatchItem(
					colorSwatchItem = "${hoveredItemColor}",
					fieldLabel = "Hovered Item Color");

				Pause(locator1 = "3000");
			}

			if (isSet(selectedItemColor)) {
				PageEditor.selectColorSwatchItem(
					colorSwatchItem = "${selectedItemColor}",
					fieldLabel = "Selected Item Color");

				Pause(locator1 = "3000");
			}
		}

		PageEditor.waitForAutoSave();
	}

	macro expandFragmentCollection {
		PageEditor.gotoTab(tabName = "Fragments and Widgets");

		Navigator.gotoNavTab(navTab = "Fragments");

		AssertVisible(
			key_collectionName = "${collectionName}",
			locator1 = "PageEditor#FRAGMENT_SIDEBAR_COLLECTION_PANEL");

		if (IsElementPresent(locator1 = "PageEditor#FRAGMENT_SIDEBAR_COLLECTION_PANEL_COLLAPSED", key_collectionName = "${collectionName}")) {
			AssertClick(
				key_collectionName = "${collectionName}",
				locator1 = "PageEditor#FRAGMENT_SIDEBAR_COLLECTION_PANEL_COLLAPSED",
				value1 = "${collectionName}");
		}

		AssertElementPresent(
			key_collectionName = "${collectionName}",
			locator1 = "PageEditor#FRAGMENT_SIDEBAR_COLLECTION_PANEL_EXPANDED");
	}

	macro getFileSizeOfSelectedImageResolution {
		var key_resolutionLabel = "File Size";

		WaitForElementPresent(locator1 = "PageEditor#IMAGE_RESOLUTION_LABEL");

		var fileSize = selenium.getText("PageEditor#IMAGE_RESOLUTION_LABEL");
		var fileSize = StringUtil.extractFirst("${fileSize}", ".");
		var fileSize = StringUtil.extractDigits("${fileSize}");

		return "${fileSize}";
	}

	macro getWidthOfSelectedImageResolution {
		var key_resolutionLabel = "Width";

		WaitForElementPresent(locator1 = "PageEditor#IMAGE_RESOLUTION_LABEL");

		var width = selenium.getText("PageEditor#IMAGE_RESOLUTION_LABEL");
		var width = StringUtil.extractDigits("${width}");

		return "${width}";
	}

	macro gotoCommentList {
		Click.pauseClickAt(locator1 = "PageEditor#FRAGMENT_SIDEBAR_BACK");

		AssertTextEquals(
			locator1 = "PageEditor#FRAGMENT_SIDEBAR_COMMENT_LIST_TITLE",
			value1 = "Comments");
	}

	macro gotoCommentViaFragment {
		var key_fragmentName = "${fragmentName}";

		if (IsNotVisible(locator1 = "Fragment#FRAGMENT_COMMENT_ICON")) {
			Click(
				key_content = "${content}",
				key_fragmentClass = "${fragmentClass}",
				locator1 = "Fragment#FRAGMENT");
		}

		Click(locator1 = "Fragment#FRAGMENT_COMMENT_ICON");

		if (IsElementNotPresent(locator1 = "PageEditor#FRAGMENT_SIDEBAR_COMMENT_SECTION_NAME")) {
			Click(
				key_content = "${content}",
				key_fragmentClass = "${fragmentClass}",
				locator1 = "Fragment#FRAGMENT");
		}
	}

	macro gotoConfiguration {
		PageEditor.clickConfigurableField(fragmentName = "${fragmentName}");

		PageEditor.gotoTab(tabName = "Selection");

		AssertElementPresent(
			key_nodeName = "${fragmentName}",
			locator1 = "Treeview#PAGE_STRUCTURE_TREE_NODE_ACTIVE");

		AssertClick(
			key_navItem = "General",
			locator1 = "PageEditor#NAV_ITEM_BUTTON",
			value1 = "General");
	}

	macro gotoContentConfiguration {
		if (isSet(entryContent)) {
			Click.clickNoMouseOver(
				key_colPosition = "${colPosition}",
				key_entryContent = "${entryContent}",
				key_fragmentName = "${fragmentName}",
				key_rowPosition = "${rowPosition}",
				locator1 = "Fragment#CONTENT_DISPLAY_FRAGMENT_BODY");
		}
		else {
			Click(
				key_fragmentName = "${fragmentName}",
				key_rowPosition = "${rowPosition}",
				locator1 = "Fragment#CONTENT_FRAGMENT_BODY");
		}

		PageEditor.gotoTab(tabName = "Selection");

		AssertClick(
			key_navItem = "General",
			locator1 = "PageEditor#NAV_ITEM_BUTTON",
			value1 = "General");
	}

	macro gotoDuplicate {
		var key_fragmentName = "${fragmentName}";

		PageEditor.clickConfigurableField(fragmentName = "${fragmentName}");

		Click.waitForMenuToggleJSClick(locator1 = "Fragment#FRAGMENT_HEADER_ELLIPSIS");

		MenuItem.click(menuItem = "Duplicate");
	}

	macro gotoEditableFieldEdit {
		id = "${id}";
		key_fragmentName = "${fragmentName}";

		PageEditor.clickEditableField(
			contributed = "${contributed}",
			fragmentName = "${fragmentName}",
			id = "${id}");

		if ("${contributed}" == "false") {
			DoubleClick(locator1 = "Fragment#EDITABLE_FIELD");
		}
		else {
			DoubleClick(locator1 = "Fragment#CONTRIBUTED_FRAGMENT_EDITABLE_FIELD");
		}
	}

	macro gotoEllipsisMenuItemInItemSelector {
		Click(
			key_fieldLabel = "${fieldLabel}",
			locator1 = "PageEditor#ITEM_SELECTOR_DROPDOWN_TOGGLE");

		MenuItem.click(menuItem = "${menuItem}");
	}

	macro gotoSaveAsFragment {
		key_fragmentName = "${fragmentName}";

		PageEditor.clickConfigurableField(fragmentName = "${fragmentName}");

		Click.waitForMenuToggleJSClick(locator1 = "Fragment#FRAGMENT_HEADER_ELLIPSIS");

		MenuItem.click(menuItem = "Save Composition");
	}

	macro gotoSelectPanel {
		PageEditor.clickConfigurableField(fragmentName = "${fragmentName}");

		PageEditor.gotoTab(tabName = "Selection");

		AssertClick(
			key_navItem = "General",
			locator1 = "PageEditor#NAV_ITEM_BUTTON",
			value1 = "General");

		WaitForElementPresent(
			key_fieldLabel = "Item",
			locator1 = "PageEditor#ITEM_SELECTOR_CONTENT_INPUT_WITH_LABEL");

		var itemSelectorContentInputValue = selenium.getElementValue("//label[normalize-space(text())='Item']/following-sibling::div//input[contains(@class,'item-selector__content-input')]");

		if ("${itemSelectorContentInputValue}" == "") {
			Click(
				key_fieldLabel = "Item",
				key_text = "plus",
				locator1 = "Icon#ANY_ITEM_SELECTOR");
		}
		else {
			Click(
				key_fieldLabel = "Item",
				key_text = "change",
				locator1 = "Icon#ANY_ITEM_SELECTOR");
		}

		SelectFrame(locator1 = "IFrame#MODAL_BODY");
	}

	macro gotoStyle {
		PageEditor.clickConfigurableField(fragmentName = "${fragmentName}");

		PageEditor.gotoTab(tabName = "Selection");

		AssertElementPresent(
			key_nodeName = "${fragmentName}",
			locator1 = "Treeview#PAGE_STRUCTURE_TREE_NODE_ACTIVE");

		AssertClick(
			key_navItem = "Styles",
			locator1 = "PageEditor#NAV_ITEM_BUTTON",
			value1 = "Styles");
	}

	macro gotoTab {
		if (IsElementNotPresent(key_sidebarButton = "${tabName}", locator1 = "PageEditor#FRAGMENT_SIDEBAR_TITLE")) {
			Click.clickNoMouseOver(
				key_tabName = "${tabName}",
				locator1 = "PageEditor#FRAGMENT_SIDEBAR_TAB_BUTTON");
		}
	}

	macro gotoTabsFragmentNavItem {
		var key_navItem = "${navItem}";

		Click.javaScriptClick(
			locator1 = "Fragment#NAV_ITEM_TAB",
			value1 = "${navItem}");

		AssertElementPresent(locator1 = "Fragment#ACTIVE_NAV_ITEM_TAB");
	}

	macro openExperienceMenu {
		Click(locator1 = "PageEditor#EXPERIENCE_DEFAULT_BUTTON_NAME");
	}

	macro prioritizeExperience {
		var key_experienceName = "${experienceName}";

		AssertTextEquals(
			locator1 = "PageEditor#EXPERIENCE_LABEL",
			value1 = "Experience");

		AssertClick(
			locator1 = "PageEditor#EXPERIENCE_BUTTON_NAME",
			value1 = "${experienceName}");

		Click(locator1 = "PageEditor#EXPERIENCE_PRIORITIZE_BUTTON");
	}

	macro removeFragment {
		var key_fragmentName = "${fragmentName}";

		PageEditor.clickConfigurableField(fragmentName = "${fragmentName}");

		Click.waitForMenuToggleJSClick(locator1 = "Fragment#FRAGMENT_HEADER_ELLIPSIS");

		MenuItem.click(menuItem = "Delete");

		if (!(isSet(duplicateFragment))) {
			AssertElementNotPresent(
				key_fragmentName = "${fragmentName}",
				locator1 = "Fragment#FRAGMENT_HEADER");
		}

		PageEditor.waitForAutoSave();
	}

	macro removeFragmentViaPageStructure {
		PageEditor.gotoTab(tabName = "Selection");

		if (IsElementNotPresent(key_nodeName = "${fragmentName}", locator1 = "Treeview#PAGE_STRUCTURE_TREE_NODE_ACTIVE")) {
			Click(
				key_nodeName = "${fragmentName}",
				locator1 = "Treeview#PAGE_STRUCTURE_TREE_NODE");
		}

		Click.clickNoWaitForVisible(
			key_nodeName = "${fragmentName}",
			locator1 = "Treeview#PAGE_STRUCTURE_TREE_NODE_DELETE");

		if (!(isSet(duplicateFragment))) {
			AssertElementNotPresent(
				key_fragmentName = "${fragmentName}",
				locator1 = "Fragment#FRAGMENT_HEADER");
		}

		PageEditor.waitForAutoSave();
	}

	macro reopenResolvedComment {
		AssertNotChecked.assertNotCheckedNotVisible(locator1 = "PageEditor#FRAGMENT_SIDEBAR_SHOW_RESOLVED_COMMENTS_CHECKBOX_UNCHECKED");

		MouseOver(locator1 = "PageEditor#FRAGMENT_SIDEBAR_SHOW_RESOLVED_COMMENTS_LABEL");

		Click(locator1 = "PageEditor#FRAGMENT_SIDEBAR_SHOW_RESOLVED_COMMENTS_LABEL");

		AssertTextEquals(
			key_fragmentComment = "${fragmentComment}",
			locator1 = "PageEditor#FRAGMENT_SIDEBAR_RESOLVED_COMMENTS_ENTRY",
			value1 = "${fragmentComment}");

		AssertTextEquals(
			key_commentReply = "${commentReply}",
			locator1 = "PageEditor#FRAGMENT_SIDEBAR_REPLY_RESOLVED_COMMENTS_ENTRY",
			value1 = "${commentReply}");

		AssertElementPresent(locator1 = "Button#REPLY_DISABLED");

		Click.clickNoMouseOver(locator1 = "Button#REOPEN");

		AssertElementPresent(locator1 = "PageEditor#FRAGMENT_SIDEBAR_SHOW_RESOLVED_COMMENTS_CHECKBOX_DISABLED");
	}

	macro replyToComment {
		AssertClick(
			locator1 = "Button#REPLY",
			value1 = "Reply");

		Type(
			locator1 = "PageEditor#FRAGMENT_SIDEBAR_REPLY_COMMENTS_EDITOR",
			value1 = "${commentReply}");

		AssertClick(
			locator1 = "Button#REPLY",
			value1 = "Reply");
	}

	macro resizeConfigurationPanel {
		PageEditor.clickConfigurableField(fragmentName = "${fragmentName}");

		AssertElementPresent(
			key_tabName = "Selection",
			locator1 = "PageEditor#FRAGMENT_SIDEBAR_TAB_BUTTON_ACTIVE");

		AssertElementPresent(
			key_nodeName = "${fragmentName}",
			locator1 = "Treeview#PAGE_STRUCTURE_TREE_NODE_ACTIVE");

		var defaultHeight = selenium.getElementHeight("PageEditor#CONFIGURATION_PANEL_CONFIGURATION");

		echo("### The default height of item configuration panel is ${defaultHeight}");

		DragAndDrop.dragAndDrop(
			locator1 = "PageEditor#CONFIGURATION_PANEL_HANDLE",
			value1 = "${position}");

		Pause(locator1 = "3000");

		var updatedHeight = selenium.getElementHeight("PageEditor#CONFIGURATION_PANEL_CONFIGURATION");

		echo("### The updated height of item configuration panel is ${updatedHeight}");

		TestUtils.assertNotEquals(
			actual = "${updatedHeight}",
			expected = "${defaultHeight}");
	}

	macro resolveComment {
		AssertElementPresent(locator1 = "PageEditor#FRAGMENT_SIDEBAR_SHOW_RESOLVED_COMMENTS_CHECKBOX_DISABLED");

		Click.clickNoMouseOver(locator1 = "Button#RESOLVE");

		AssertTextNotPresent(value1 = "${fragmentComment}");
	}

	macro searchFragmentViaSidebar {
		WaitForPageLoad();

		PageEditor.gotoTab(tabName = "Fragments");

		Type(
			locator1 = "PageEditor#WIDGETS_APPLICATION_SEARCH_FIELD",
			value1 = "${fragmentName}");
	}

	macro selectColorSwatchItem {
		Click(
			key_fieldLabel = "${fieldLabel}",
			locator1 = "Button#COLOR_PICKER");

		Click(
			key_colorSwatchItem = "${colorSwatchItem}",
			locator1 = "Button#COLOR_SWATCH_ITEM");
	}

	macro viewAutoSaveMessage {
		AssertTextEquals.assertPartialText(
			locator1 = "PageEditor#AUTOSAVE_MESSAGE",
			value1 = "Saved");
	}

	macro viewCannotAddFragmentToOutsideOfDropZone {
		WaitForPageLoad();

		PageEditor.gotoTab(tabName = "Fragments");

		PageEditor.expandFragmentCollection(collectionName = "${collectionName}");

		DragAndDrop(
			key_collectionName = "${collectionName}",
			key_fragmentName = "${fragmentName}",
			locator1 = "PageEditor#FRAGMENTS_AND_WIDGETS_TAB_FRAGMENT",
			locator2 = "PageEditor#OUTSIDE_OF_DROP_ZONE",
			value1 = "");

		AssertElementNotPresent(
			key_fragmentName = "${fragmentName}",
			locator1 = "Fragment#FRAGMENT_HEADER");
	}

	macro viewCollectionNotPresent {
		AssertElementNotPresent(
			key_collectionName = "${collectionName}",
			locator1 = "PageEditor#FRAGMENT_SIDEBAR_COLLECTION_PANEL");
	}

	macro viewComment {
		if (isSet(fragmentComment)) {
			if (isSet(fromNotifications)) {
				AssertTextEquals(
					key_fragmentComment = "${fragmentComment}",
					locator1 = "PageEditor#FRAGMENT_SIDEBAR_COMMENT_ENTRY_HIGHLIGHTED",
					value1 = "${fragmentComment}");
			}

			else if (isSet(mentionsUserScreenName)) {
				AssertTextEquals(
					key_fragmentComment = "${fragmentComment}",
					locator1 = "PageEditor#FRAGMENT_SIDEBAR_COMMENT_ENTRY",
					value1 = "${fragmentComment}@${mentionsUserScreenName}");

				Mentions.viewMentionTagLink(
					mentionsUserFullName = "${mentionsUserFullName}",
					mentionsUserScreenName = "${mentionsUserScreenName}");
			}

			else {
				AssertTextEquals(
					key_fragmentComment = "${fragmentComment}",
					locator1 = "PageEditor#FRAGMENT_SIDEBAR_COMMENT_ENTRY",
					value1 = "${fragmentComment}");
			}
		}

		else {
			AssertTextEquals(
				locator1 = "PageEditor#FRAGMENT_SIDEBAR_SECTION_TITLE",
				value1 = "Comments");

			AssertTextEquals(
				locator1 = "PageEditor#FRAGMENT_SIDEBAR_CENTER_TEXT",
				value1 = "There are no comments yet.");

			AssertTextEquals(
				locator1 = "PageEditor#FRAGMENT_SIDEBAR_SECONDARY_TEXT",
				value1 = "Select a fragment to add a comment.");
		}

		if (isSet(key_fragmentName)) {
			AssertElementPresent(
				key_fragmentName = "Rich Text",
				locator1 = "PageEditor#FRAGMENT_SIDEBAR_COMMENT_SECTION_NAME");
		}
	}

	macro viewCommentList {
		AssertTextEquals(
			key_fragmentName = "${fragmentName}",
			locator1 = "PageEditor#FRAGMENT_SIDEBAR_COMMENT_LIST_HEADING",
			value1 = "${fragmentName}");

		AssertTextEquals(
			key_commentCount = "${commentCount}",
			locator1 = "PageEditor#FRAGMENT_SIDEBAR_COMMENT_LIST_SECONDARY_TEXT",
			value1 = "${commentCount}");

		if (isSet(openComment)) {
			Click(
				key_fragmentName = "${fragmentName}",
				locator1 = "PageEditor#FRAGMENT_SIDEBAR_COMMENT_LIST_HEADING");
		}
	}

	macro viewCommentReply {
		if (isSet(fromNotifications)) {
			AssertTextEquals(
				key_commentReply = "${commentReply}",
				locator1 = "PageEditor#FRAGMENT_SIDEBAR_REPLY_COMMENTS_ENTRY_HIGHLIGHTED",
				value1 = "${commentReply}");
		}

		else {
			AssertTextEquals(
				key_commentReply = "${commentReply}",
				locator1 = "PageEditor#FRAGMENT_SIDEBAR_REPLY_COMMENTS_ENTRY",
				value1 = "${commentReply}");
		}

		AssertTextEquals(
			key_commentReply = "${commentReply}",
			locator1 = "PageEditor#FRAGMENT_SIDEBAR_REPLY_COMMENTS_ENTRY_AUTHOR",
			value1 = "${user}");
	}

	macro viewContainerStyle {
		if (isSet(alignItems)) {
			AssertElementPresent(
				key_alignItems = "${alignItems}",
				key_position = "${position}",
				locator1 = "PageEditor#CONTAINER_CONFIGURATION_ALIGN_ITEMS");
		}

		if (isSet(backgroundColor)) {
			AssertElementPresent(
				key_paletteItem = "${backgroundColor}",
				key_position = "${position}",
				locator1 = "PageEditor#CONTAINER_CONFIGURATION_BACKGROUND_COLOR");
		}

		if (isSet(backgroundImage)) {
			AssertElementPresent(
				key_imageName = "${backgroundImage}",
				key_position = "${position}",
				locator1 = "PageEditor#CONTAINER_CONFIGURATION_BACKGROUND_IMAGE");
		}

		if (isSet(borderColor)) {
			AssertElementPresent(
				key_paletteItem = "${borderColor}",
				key_position = "${position}",
				locator1 = "PageEditor#CONTAINER_CONFIGURATION_BORDER_COLOR");
		}

		if (isSet(borderRadius)) {
			AssertElementPresent(
				key_borderRadius = "${borderRadius}",
				key_position = "${position}",
				locator1 = "PageEditor#CONTAINER_CONFIGURATION_BORDER_RADIUS");
		}

		if (isSet(borderWidth)) {
			AssertElementPresent(
				key_borderWidth = "${borderWidth}",
				key_position = "${position}",
				locator1 = "PageEditor#CONTAINER_CONFIGURATION_BORDER_WIDTH");
		}

		if (isSet(boxShadow)) {
			AssertElementPresent(
				key_boxShadow = "${boxShadow}",
				key_position = "${position}",
				locator1 = "PageEditor#CONTAINER_CONFIGURATION_BOX_SHADOW");
		}

		if (isSet(containerWidth)) {
			if ("${containerWidth}" == "Fixed Width") {
				AssertElementPresent(
					key_position = "${position}",
					locator1 = "PageEditor#CONTAINER_CONFIGURATION_FIXED_WIDTH");

				AssertElementNotPresent(
					key_marginLeft = "",
					key_position = "${position}",
					locator1 = "PageEditor#CONTAINER_CONFIGURATION_MARGIN_LEFT");

				AssertElementNotPresent(
					key_marginRight = "",
					key_position = "${position}",
					locator1 = "PageEditor#CONTAINER_CONFIGURATION_MARGIN_RIGHT");
			}
			else if ("${containerWidth}" == "Fluid") {
				AssertElementNotPresent(
					key_position = "${position}",
					locator1 = "PageEditor#CONTAINER_CONFIGURATION_FIXED_WIDTH");
			}
		}

		if (isSet(contentDisplay)) {
			AssertElementPresent(
				key_contentDisplay = "${contentDisplay}",
				key_position = "${position}",
				locator1 = "PageEditor#CONTAINER_CONFIGURATION_CONTENT_DISPLAY");
		}

		if (isSet(justifyContent)) {
			AssertElementPresent(
				key_justifyContent = "${justifyContent}",
				key_position = "${position}",
				locator1 = "PageEditor#CONTAINER_CONFIGURATION_JUSTIFY_CONTENT");
		}

		if (isSet(height)) {
			AssertElementPresent(
				key_height = "${height}",
				key_position = "${position}",
				locator1 = "PageEditor#CONTAINER_CONFIGURATION_HEIGHT");
		}

		if (isSet(marginBottom)) {
			AssertElementPresent(
				key_marginBottom = "${marginBottom}",
				key_position = "${position}",
				locator1 = "PageEditor#CONTAINER_CONFIGURATION_MARGIN_BOTTOM");
		}

		if (isSet(marginLeft)) {
			AssertElementPresent(
				key_marginLeft = "${marginLeft}",
				key_position = "${position}",
				locator1 = "PageEditor#CONTAINER_CONFIGURATION_MARGIN_LEFT");
		}

		if (isSet(marginRight)) {
			AssertElementPresent(
				key_marginRight = "${marginRight}",
				key_position = "${position}",
				locator1 = "PageEditor#CONTAINER_CONFIGURATION_MARGIN_RIGHT");
		}

		if (isSet(marginTop)) {
			AssertElementPresent(
				key_marginTop = "${marginTop}",
				key_position = "${position}",
				locator1 = "PageEditor#CONTAINER_CONFIGURATION_MARGIN_TOP");
		}

		if (isSet(opacity)) {
			AssertElementPresent(
				key_opacity = "${opacity}",
				key_position = "${position}",
				locator1 = "PageEditor#CONTAINER_CONFIGURATION_OPACITY");
		}

		if (isSet(paddingBottom)) {
			AssertElementPresent(
				key_paddingBottom = "${paddingBottom}",
				key_position = "${position}",
				locator1 = "PageEditor#CONTAINER_CONFIGURATION_PADDING_BOTTOM");
		}

		if (isSet(paddingLeft)) {
			AssertElementPresent(
				key_paddingLeft = "${paddingLeft}",
				key_position = "${position}",
				locator1 = "PageEditor#CONTAINER_CONFIGURATION_PADDING_LEFT");
		}

		if (isSet(paddingRight)) {
			AssertElementPresent(
				key_paddingRight = "${paddingRight}",
				key_position = "${position}",
				locator1 = "PageEditor#CONTAINER_CONFIGURATION_PADDING_RIGHT");
		}

		if (isSet(paddingTop)) {
			AssertElementPresent(
				key_paddingTop = "${paddingTop}",
				key_position = "${position}",
				locator1 = "PageEditor#CONTAINER_CONFIGURATION_PADDING_TOP");
		}
	}

	macro viewDuplicateFragment {
		AssertElementPresent(
			key_fragmentName = "${fragmentName}",
			key_index = "2",
			locator1 = "Fragment#FRAGMENT_HEADER_ANY");
	}

	macro viewEditorEmpty {
		AssertElementPresent(locator1 = "PageEditor#EMPTY_MESSAGE");
	}

	macro viewFragment {
		AssertElementPresent(
			key_fragmentName = "${fragmentName}",
			locator1 = "Fragment#FRAGMENT_HEADER");
	}

	macro viewFragmentEditableImage {
		if ("${contributed}" == "false") {
			AssertVisible(
				key_fragmentClass = "${fragmentClass}",
				key_image = "${imageFileName}",
				locator1 = "Fragment#PAGE_EDITOR_FRAGMENT_IMAGE");
		}
		else {
			if (contains("${id}", "banner")) {
				AssertVisible(
					id = "${id}",
					key_image = "${imageFileName}",
					locator1 = "Fragment#BACKGROUND_IMAGE_EDITABLE_FIELD_IMAGE_PROPERTIES");
			}
			else {
				AssertVisible(
					id = "${id}",
					key_image = "${imageFileName}",
					key_imageDescription = "${imageDescription}",
					locator1 = "Fragment#CONTRIBUTED_FRAGMENT_EDITABLE_FIELD_IMAGE_PROPERTIES");
			}
		}
	}

	macro viewFragmentEditableText {
		if (!(isSet(position))) {
			var position = "1";
		}

		if ("${contributed}" == "false") {
			AssertTextEquals(
				id = "${id}",
				key_fragmentName = "${fragmentName}",
				locator1 = "Fragment#EDITABLE_FIELD",
				value1 = "${editableText}");

			if (isSet(style)) {
				AssertVisible(
					id = "${id}",
					key_position = "${position}",
					key_style = "${style}",
					key_text = "${editableText}",
					locator1 = "Fragment#INLINE_RICH_TEXT_STYLE");
			}
		}
		else {
			AssertTextEquals(
				id = "${id}",
				key_fragmentName = "${fragmentName}",
				locator1 = "Fragment#CONTRIBUTED_FRAGMENT_EDITABLE_FIELD",
				value1 = "${editableText}");

			if (isSet(style)) {
				AssertVisible(
					id = "${id}",
					key_position = "${position}",
					key_style = "${style}",
					key_text = "${editableText}",
					locator1 = "Fragment#CONTRIBUTED_FRAGMENT_INLINE_RICH_TEXT_STYLE");
			}
		}
	}

	macro viewFragmentOrder {
		AssertElementPresent(
			key_fragmentName = "${fragmentName}",
			key_position = "${position}",
			locator1 = "Fragment#FRAGMENT_HEADER_POSITION");
	}

	macro viewFragmentStyle {
		if (isSet(alignment)) {
			var fragmentName = StringUtil.upperCaseFirstLetter("${fragmentName}");

			AssertElementPresent(
				key_alignment = "${alignment}",
				key_fragmentName = "${fragmentName}",
				locator1 = "Fragment#FRAGMENT_CONFIGURATION_ALIGNMENT");
		}

		if (isSet(backgroundColor)) {
			var fragmentName = StringUtil.upperCaseFirstLetter("${fragmentName}");

			AssertElementPresent(
				key_fragmentName = "${fragmentName}",
				key_paletteItem = "${backgroundColor}",
				locator1 = "Fragment#FRAGMENT_CONFIGURATION_BACKGROUND_COLOR");
		}

		if (isSet(borderColor)) {
			var fragmentName = StringUtil.upperCaseFirstLetter("${fragmentName}");

			AssertElementPresent(
				key_fragmentName = "${fragmentName}",
				key_paletteItem = "${borderColor}",
				locator1 = "Fragment#FRAGMENT_CONFIGURATION_BORDER_COLOR");
		}

		if (isSet(borderRadius)) {
			var fragmentName = StringUtil.upperCaseFirstLetter("${fragmentName}");

			AssertElementPresent(
				key_borderRadius = "${borderRadius}",
				key_fragmentName = "${fragmentName}",
				locator1 = "Fragment#FRAGMENT_CONFIGURATION_BORDER_RADIUS");
		}

		if (isSet(bottomSpacing)) {
			AssertElementPresent(
				key_bottomSpacing = "${bottomSpacing}",
				locator1 = "Fragment#BOTTOM_SPACING");
		}

		if (isSet(boxShadow)) {
			var fragmentName = StringUtil.upperCaseFirstLetter("${fragmentName}");

			AssertElementPresent(
				key_boxShadow = "${boxShadow}",
				key_fragmentName = "${fragmentName}",
				locator1 = "Fragment#FRAGMENT_CONFIGURATION_BOX_SHADOW");
		}

		if (isSet(headingLevel)) {
			var fragmentName = StringUtil.lowerCase("${fragmentName}");

			AssertElementPresent(
				key_fragmentName = "${fragmentName}",
				key_headingLevel = "${headingLevel}",
				locator1 = "Fragment#FRAGMENT_CONFIGURATION_HEADER");
		}

		if (isSet(height)) {
			AssertElementPresent(
				key_height = "${height}",
				locator1 = "Fragment#SPACER_HEIGHT");
		}

		if (isSet(imageSize)) {
			var fragmentName = StringUtil.lowerCase("${fragmentName}");

			AssertElementPresent(
				key_fragmentName = "${fragmentName}",
				key_imageSize = "${imageSize}",
				locator1 = "Fragment#IMAGE_SIZE");
		}

		if (isSet(marginBottom)) {
			var fragmentName = StringUtil.upperCaseFirstLetter("${fragmentName}");

			AssertElementPresent(
				key_fragmentName = "${fragmentName}",
				key_marginBottom = "${marginBottom}",
				locator1 = "Fragment#FRAGMENT_CONFIGURATION_MARGIN_BOTTOM");
		}

		if (isSet(marginLeft)) {
			var fragmentName = StringUtil.upperCaseFirstLetter("${fragmentName}");

			AssertElementPresent(
				key_fragmentName = "${fragmentName}",
				key_marginLeft = "${marginLeft}",
				locator1 = "Fragment#FRAGMENT_CONFIGURATION_MARGIN_LEFT");
		}

		if (isSet(marginRight)) {
			var fragmentName = StringUtil.upperCaseFirstLetter("${fragmentName}");

			AssertElementPresent(
				key_fragmentName = "${fragmentName}",
				key_marginRight = "${marginRight}",
				locator1 = "Fragment#FRAGMENT_CONFIGURATION_MARGIN_RIGHT");
		}

		if (isSet(marginTop)) {
			var fragmentName = StringUtil.upperCaseFirstLetter("${fragmentName}");

			AssertElementPresent(
				key_fragmentName = "${fragmentName}",
				key_marginTop = "${marginTop}",
				locator1 = "Fragment#FRAGMENT_CONFIGURATION_MARGIN_TOP");
		}

		if (isSet(paddingBottom)) {
			var fragmentName = StringUtil.upperCaseFirstLetter("${fragmentName}");

			AssertElementPresent(
				key_fragmentName = "${fragmentName}",
				key_paddingBottom = "${paddingBottom}",
				locator1 = "Fragment#FRAGMENT_CONFIGURATION_PADDING_BOTTOM");
		}

		if (isSet(paddingLeft)) {
			var fragmentName = StringUtil.upperCaseFirstLetter("${fragmentName}");

			AssertElementPresent(
				key_fragmentName = "${fragmentName}",
				key_paddingLeft = "${paddingLeft}",
				locator1 = "Fragment#FRAGMENT_CONFIGURATION_PADDING_LEFT");
		}

		if (isSet(paddingRight)) {
			var fragmentName = StringUtil.upperCaseFirstLetter("${fragmentName}");

			AssertElementPresent(
				key_fragmentName = "${fragmentName}",
				key_paddingRight = "${paddingRight}",
				locator1 = "Fragment#FRAGMENT_CONFIGURATION_PADDING_RIGHT");
		}

		if (isSet(paddingTop)) {
			var fragmentName = StringUtil.upperCaseFirstLetter("${fragmentName}");

			AssertElementPresent(
				key_fragmentName = "${fragmentName}",
				key_paddingTop = "${paddingTop}",
				locator1 = "Fragment#FRAGMENT_CONFIGURATION_PADDING_TOP");
		}

		if (isSet(separatorColor)) {
			AssertElementPresent(
				key_separatorColor = "${separatorColor}",
				locator1 = "Fragment#SEPARATOR_COLOR");
		}

		if (isSet(size)) {
			var fragmentName = StringUtil.lowerCase("${fragmentName}");

			AssertElementPresent(
				key_fragmentName = "${fragmentName}",
				key_size = "${size}",
				locator1 = "Fragment#BUTTON_SIZE");
		}

		if (isSet(textColor)) {
			var fragmentName = StringUtil.upperCaseFirstLetter("${fragmentName}");

			AssertElementPresent(
				key_fragmentName = "${fragmentName}",
				key_textColor = "${textColor}",
				locator1 = "Fragment#FRAGMENT_CONFIGURATION_TEXT_COLOR");
		}

		if (isSet(type)) {
			var fragmentName = StringUtil.lowerCase("${fragmentName}");

			AssertElementPresent(
				key_fragmentName = "${fragmentName}",
				key_type = "${type}",
				locator1 = "Fragment#FRAGMENT_CONFIGURATION_TYPE");
		}
	}

	macro viewGridStyle {
		if (isSet(columnCount)) {
			var i = "0";

			while ("${i}" != "${columnCount}") {
				var columnNumber = ${i} + 1;

				AssertElementPresent(
					key_columnNumber = "${columnNumber}",
					key_position = "${position}",
					locator1 = "PageEditor#GRID_COLUMN");
			}

			var columnNumber = ${columnCount} + 1;

			AssertElementNotPresent(
				key_columnNumber = "${columnNumber}",
				key_position = "${position}",
				locator1 = "PageEditor#GRID_COLUMN");
		}

		if (isSet(inverseOrder)) {
			AssertElementPresent(
				key_position = "${position}",
				locator1 = "PageEditor#GRID_CONFIGURATION_INVERSE_ORDER");
		}

		if (isSet(layout)) {
			AssertElementPresent(
				key_layout = "${layout}",
				key_position = "${position}",
				locator1 = "PageEditor#GRID_CONFIGURATION_LAYOUT");
		}

		if (isSet(spaceBetweenColumns)) {
			if ("${spaceBetweenColumns}" == "true") {
				AssertElementNotPresent(
					key_position = "${position}",
					locator1 = "PageEditor#GRID_CONFIGURATION_COLUMNS_NO_GUTTER");
			}
			else if ("${spaceBetweenColumns}" == "false") {
				AssertElementPresent(
					key_position = "${position}",
					locator1 = "PageEditor#GRID_CONFIGURATION_COLUMNS_NO_GUTTER");
			}
		}

		if ("${verticalAlignment}" == "Top") {
			AssertElementPresent(
				key_position = "${position}",
				key_verticalAlignment = "",
				locator1 = "PageEditor#GRID_CONFIGURATION_VERTICAL_ALIGNMENT");
		}
		else if ("${verticalAlignment}" == "Middle") {
			AssertElementPresent(
				key_position = "${position}",
				key_verticalAlignment = "middle",
				locator1 = "PageEditor#GRID_CONFIGURATION_VERTICAL_ALIGNMENT");
		}
		else if ("${verticalAlignment}" == "Bottom") {
			AssertElementPresent(
				key_position = "${position}",
				key_verticalAlignment = "bottom",
				locator1 = "PageEditor#GRID_CONFIGURATION_VERTICAL_ALIGNMENT");
		}
	}

	macro viewMentionsDisplayOption {
		Click.clickAt(locator1 = "PageEditor#FRAGMENT_SIDEBAR_COMMENTS");

		Type.sendKeys(
			locator1 = "PageEditor#FRAGMENT_SIDEBAR_COMMENTS",
			value1 = "${fragmentComment}");

		if (isSet(noMentionsUserScreenName)) {
			AssertElementNotPresent(
				key_mentionsUserScreenName = "${noMentionsUserScreenName}",
				locator1 = "Mentions#MENTIONS_USER_DISPLAY_OPTION");
		}

		AssertElementPresent(
			key_mentionsUserScreenName = "${mentionsUserScreenName}",
			locator1 = "Mentions#MENTIONS_USER_DISPLAY_OPTION");

		Click.clickNoMouseOver(
			key_mentionsUserScreenName = "${mentionsUserScreenName}",
			locator1 = "Mentions#MENTIONS_USER_DISPLAY_OPTION");
	}

	macro viewNoFragment {
		AssertElementNotPresent(
			key_fragmentName = "${fragmentName}",
			locator1 = "Fragment#FRAGMENT_HEADER");
	}

	macro waitForAutoSave {
		WaitForElementPresent(locator1 = "PageEditor#AUTOSAVE_MESSAGE");
	}

}